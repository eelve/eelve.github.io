{"name":"SpringBoot","postlist":[{"title":"SpringBootè‡ªå®šä¹‰Starter","slug":"SpringBootè‡ªå®šä¹‰Starter","date":"2020-04-05T04:01:17.000Z","updated":"2021-04-19T06:44:39.042Z","comments":true,"path":"api/articles/SpringBootè‡ªå®šä¹‰Starter.json","excerpt":null,"keywords":"å—å›½è–ç±³","cover":"https://image.eelve.com/eblog/eblog-b269767ff45b4e01a1c380e38898c1c0.png","content":"<p>ã€<strong>å‰é¢çš„è¯</strong>ã€‘åœ¨ä½¿ç”¨SpringBootçš„æ—¥å¸¸å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¸å¯é¿å…çš„è¦å°è£…ä¸€äº›è‡ªå·±çš„Starterï¼Œä»Šå¤©è¿™ç¯‡æ–‡ç« å°±æ¥è®¨è®ºä¸€ä¸‹æ€ä¹ˆè‡ªå®šä¹‰ä¸€ä¸ªStarterï¼Œæœ¬æ–‡ä¼šå°è£…ä¸€ä¸ªçŸ­ä¿¡å‘é€èƒ½åŠ›çš„Starter,ä½¿ç”¨<a href=\"https://office.ucpaas.com/about/index.html\">äº‘ä¹‹è®¯</a>çš„SDKã€‚</p>\n<hr>\n<h1 id=\"å£¹ã€å‘½åè§„èŒƒ\"><a href=\"#å£¹ã€å‘½åè§„èŒƒ\" class=\"headerlink\" title=\"å£¹ã€å‘½åè§„èŒƒ\"></a>å£¹ã€å‘½åè§„èŒƒ</h1><p>å®˜æ–¹çš„çº¦å®šä¸»è¦æœ‰ä¸€ä¸ªå‘½åçš„çº¦å®šï¼šåœ¨mavenä¸­ï¼ŒgroupIdä»£è¡¨ç€å§“æ°ï¼ŒartifactIdä»£è¡¨ç€åå­—ã€‚Spring Bootä¹Ÿæ˜¯æœ‰ä¸€ä¸ªå‘½åçš„å»ºè®®çš„ã€‚groupIdä¸è¦ç”¨å®˜æ–¹çš„org.springframework.bootè€Œè¦ç”¨ä½ è‡ªå·±ç‹¬ç‰¹çš„ã€‚å¯¹äºartifactIdçš„å‘½åï¼ŒSpring Bootå®˜æ–¹å»ºè®®éå®˜æ–¹çš„Starterå‘½åæ ¼å¼éµå¾ª xxxx-spring-boot-starter ï¼Œä¾‹å¦‚ mybatis-spring-boot-starter ã€‚å®˜æ–¹starterä¼šéµå¾ªspring-boot-starter-xxxx ,ä¾‹å¦‚spring-boot-starter-web ã€‚å¾ˆå¤šå¼€æºstarterä½œè€…ä¼šå¿½ç•¥è¿™ç§çº¦å®šï¼Œæ˜¾å¾—ä¸å¤Ÿâ€œä¸“ä¸šâ€œã€‚</p>\n<h1 id=\"è´°ã€æ–°å»ºå·¥ç¨‹\"><a href=\"#è´°ã€æ–°å»ºå·¥ç¨‹\" class=\"headerlink\" title=\"è´°ã€æ–°å»ºå·¥ç¨‹\"></a>è´°ã€æ–°å»ºå·¥ç¨‹</h1><p>æ–°å»ºä¸€ä¸ª<strong>sms-spring-boot-starter</strong>å·¥ç¨‹ï¼Œpomä¾èµ–å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--å°è£…Starteræ ¸å¿ƒä¾èµ–  --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-autoconfigure<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.2.4.RELEASE<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--éå¿…éœ€,è¯¥ä¾èµ–ä½œç”¨æ˜¯åœ¨ä½¿ç”¨IDEAç¼–å†™é…ç½®æ–‡ä»¶æœ‰ä»£ç æç¤º--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-configuration-processor<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.2.4.RELEASE<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- lombok æ’ä»¶  --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.projectlombok<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>lombok<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>1.18.6<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">optional</span>&gt;</span>true<span class=\"tag\">&lt;/<span class=\"name\">optional</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- å› ä¸ºè¦ä½¿ç”¨RestTemplateå’Œè½¬æ¢Jsonï¼Œæ‰€ä»¥å¼•å…¥è¿™ä¸¤ä¸ªä¾èµ– --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-web<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.2.4.RELEASE<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.alibaba<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>fastjson<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>1.2.61<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h1 id=\"åã€Propertiesé…ç½®\"><a href=\"#åã€Propertiesé…ç½®\" class=\"headerlink\" title=\"åã€Propertiesé…ç½®\"></a>åã€Propertiesé…ç½®</h1><p>ä¸€èˆ¬é…ç½®å‚æ•°éƒ½æ˜¯åœ¨Spring Boot çš„application.ymlä¸­ã€‚æˆ‘ä»¬ä¼šå®šä¹‰ä¸€ä¸ªå‰ç¼€æ ‡è¯†æ¥ä½œä¸ºåç§°ç©ºé—´éš”ç¦»å„ä¸ªç»„ä»¶çš„å‚æ•°ã€‚å¯¹åº”çš„ç»„ä»¶ä¼šå®šä¹‰ä¸€ä¸ªXXXXProperties æ¥è‡ªåŠ¨è£…é…è¿™äº›å‚æ•°ã€‚è‡ªåŠ¨è£…é…çš„æœºåˆ¶åŸºäº@ConfigurationPropertiesæ³¨è§£ï¼Œè¯·æ³¨æ„ä¸€å®šè¦æ˜¾å¼å£°æ˜ä½ é…ç½®çš„å‰ç¼€æ ‡è¯†ï¼ˆprefixï¼‰ã€‚æ‰€ä»¥è¿™é‡Œæˆ‘ä»¬æ–°å»º<strong>SmsProperties</strong>ç±»ï¼Œå¯ä»¥é…ç½®ä¿¡æ¯é€šè¿‡é…ç½®é¡¹åç§°æ˜ å°„æˆå®ä½“ç±»</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Data</span></span><br><span class=\"line\"><span class=\"meta\">@ConfigurationProperties(prefix = &quot;ucpaassms-config&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">SmsProperties</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String appid;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String accountSid;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String authToken;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>åœ¨è¿™é‡Œæˆ‘ä»¬å¯ä»¥å°†é…ç½®æ–‡ä»¶ä¸­å‰ç¼€ä¸º<strong>ucpaassms-config</strong>çš„é…ç½®ï¼Œæ˜ å°„åˆ°<strong>SmsProperties</strong>ç±»ä¸­ã€‚åœ¨å°†æ¥ä½¿ç”¨æ—¶åªéœ€è¦åœ¨application.ymlä¸­åŠ å…¥ä¸Šé¢å¯¹åº”SmsPropertiesçš„é…ç½®ï¼š</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">ucpaassms-config:</span></span><br><span class=\"line\">  <span class=\"attr\">account-sid:</span>  <span class=\"string\">//è¿™é‡Œå¡«å†™å¹³å°è·å–çš„IDå’ŒKEY</span></span><br><span class=\"line\">  <span class=\"attr\">auth-token:</span>   <span class=\"string\">//è¿™é‡Œå¡«å†™å¹³å°è·å–çš„IDå’ŒKEY</span></span><br><span class=\"line\">  <span class=\"attr\">appid:</span>        <span class=\"string\">//è¿™é‡Œå¡«å†™å¹³å°è·å–çš„IDå’ŒKEY</span></span><br></pre></td></tr></table></figure>\n<h1 id=\"è‚†ã€å®šä¹‰ä¸šåŠ¡å®ç°ç±»\"><a href=\"#è‚†ã€å®šä¹‰ä¸šåŠ¡å®ç°ç±»\" class=\"headerlink\" title=\"è‚†ã€å®šä¹‰ä¸šåŠ¡å®ç°ç±»\"></a>è‚†ã€å®šä¹‰ä¸šåŠ¡å®ç°ç±»</h1><p>æ‹¿åˆ°é…ç½®åï¼Œæ¥ä¸‹æ¥å°±æ˜¯æ ¹æ®é…ç½®æ¥åˆå§‹åŒ–æˆ‘ä»¬çš„åŠŸèƒ½æ¥å£ã€‚è¿™é‡Œæˆ‘ä»¬æ–°å»º<strong>SmsService</strong>ï¼Œç”¨æ¥æä¾›å…·ä½“ä¸šåŠ¡é€»è¾‘å¤„ç†èƒ½åŠ›</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">SmsService</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> RestTemplate restTemplate;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String appid;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String accountSid;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String authToken;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * åˆå§‹åŒ–</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">SmsService</span><span class=\"params\">(SmsProperties smsProperties)</span> </span>&#123;</span><br><span class=\"line\">       <span class=\"keyword\">this</span>.appid = smsProperties.getAppid();</span><br><span class=\"line\">       <span class=\"keyword\">this</span>.accountSid = smsProperties.getAccountSid();</span><br><span class=\"line\">       <span class=\"keyword\">this</span>.authToken = smsProperties.getAuthToken();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * å•ç‹¬å‘é€</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">sendSMS</span><span class=\"params\">(SendSMSDTO sendSMSDTO)</span></span>&#123;</span><br><span class=\"line\">        JSONObject jsonObject = <span class=\"keyword\">new</span> JSONObject();</span><br><span class=\"line\">        jsonObject.put(<span class=\"string\">&quot;sid&quot;</span>, accountSid);</span><br><span class=\"line\">        jsonObject.put(<span class=\"string\">&quot;token&quot;</span>, authToken);</span><br><span class=\"line\">        jsonObject.put(<span class=\"string\">&quot;appid&quot;</span>, appid);</span><br><span class=\"line\">        jsonObject.put(<span class=\"string\">&quot;templateid&quot;</span>, sendSMSDTO.getTemplateid());</span><br><span class=\"line\">        jsonObject.put(<span class=\"string\">&quot;param&quot;</span>, sendSMSDTO.getParam());</span><br><span class=\"line\">        jsonObject.put(<span class=\"string\">&quot;mobile&quot;</span>, sendSMSDTO.getMobile());</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (sendSMSDTO.getUid()!=<span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">            jsonObject.put(<span class=\"string\">&quot;uid&quot;</span>,sendSMSDTO.getUid());</span><br><span class=\"line\">        &#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            jsonObject.put(<span class=\"string\">&quot;uid&quot;</span>,<span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        String json = JSONObject.toJSONString(jsonObject);</span><br><span class=\"line\">        <span class=\"comment\">//ä½¿ç”¨restTemplateè¿›è¡Œè®¿é—®è¿œç¨‹HttpæœåŠ¡</span></span><br><span class=\"line\">        HttpHeaders headers = <span class=\"keyword\">new</span> HttpHeaders();</span><br><span class=\"line\">        headers.setContentType(MediaType.APPLICATION_JSON_UTF8);</span><br><span class=\"line\">        HttpEntity&lt;String&gt; httpEntity = <span class=\"keyword\">new</span> HttpEntity&lt;String&gt;(json, headers);</span><br><span class=\"line\">        String result = restTemplate.postForObject(ENUM_SMSAPI_URL.SENDSMS.getUrl(), httpEntity, String.class);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> result;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * ç¾¤ä½“å‘é€</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">sendBatchSMS</span><span class=\"params\">(SendSMSDTO sendSMSDTO)</span></span>&#123;</span><br><span class=\"line\">        JSONObject jsonObject = <span class=\"keyword\">new</span> JSONObject();</span><br><span class=\"line\">        jsonObject.put(<span class=\"string\">&quot;sid&quot;</span>, accountSid);</span><br><span class=\"line\">        jsonObject.put(<span class=\"string\">&quot;token&quot;</span>, authToken);</span><br><span class=\"line\">        jsonObject.put(<span class=\"string\">&quot;appid&quot;</span>, appid);</span><br><span class=\"line\">        jsonObject.put(<span class=\"string\">&quot;templateid&quot;</span>, sendSMSDTO.getTemplateid());</span><br><span class=\"line\">        jsonObject.put(<span class=\"string\">&quot;param&quot;</span>, sendSMSDTO.getParam());</span><br><span class=\"line\">        jsonObject.put(<span class=\"string\">&quot;mobile&quot;</span>, sendSMSDTO.getMobile());</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (sendSMSDTO.getUid()!=<span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">            jsonObject.put(<span class=\"string\">&quot;uid&quot;</span>,sendSMSDTO.getUid());</span><br><span class=\"line\">        &#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            jsonObject.put(<span class=\"string\">&quot;uid&quot;</span>,<span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        String json = JSONObject.toJSONString(jsonObject);</span><br><span class=\"line\">        <span class=\"comment\">//ä½¿ç”¨restTemplateè¿›è¡Œè®¿é—®è¿œç¨‹HttpæœåŠ¡</span></span><br><span class=\"line\">        HttpHeaders headers = <span class=\"keyword\">new</span> HttpHeaders();</span><br><span class=\"line\">        headers.setContentType(MediaType.APPLICATION_JSON_UTF8);</span><br><span class=\"line\">        HttpEntity&lt;String&gt; httpEntity = <span class=\"keyword\">new</span> HttpEntity&lt;String&gt;(json, headers);</span><br><span class=\"line\">        String result = restTemplate.postForObject(ENUM_SMSAPI_URL.SENDBATCHSMS.getUrl(), httpEntity, String.class);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> result;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h1 id=\"ä¼ã€å®šä¹‰é…ç½®ç±»\"><a href=\"#ä¼ã€å®šä¹‰é…ç½®ç±»\" class=\"headerlink\" title=\"ä¼ã€å®šä¹‰é…ç½®ç±»\"></a>ä¼ã€å®šä¹‰é…ç½®ç±»</h1><p>åŠŸèƒ½æ¥å£å®ç°å®Œåæˆ‘ä»¬ä¼šç¼–å†™ä¸€ä¸ªè‡ªåŠ¨é…ç½®ç±» SmsAutoConfiguration ã€‚é™¤äº†@Configurationæ³¨è§£å¤–ï¼Œ@EnableConfigurationPropertiesä¼šå¸®åŠ©æˆ‘ä»¬å°†æˆ‘ä»¬çš„é…ç½®ç±»SmsPropertiesåŠ è½½è¿›æ¥ã€‚ç„¶åå°†æˆ‘ä»¬éœ€è¦æš´éœ²çš„åŠŸèƒ½æ¥å£å£°æ˜ä¸ºSpring Beanæš´éœ²ç»™Spring Bootåº”ç”¨ã€‚è¿™é‡Œæˆ‘ä»¬æ–°å»º<strong>SmsAutoConfiguration</strong>ç±»</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Configuration</span>  <span class=\"comment\">//æ³¨é‡Šä½¿ç±»æˆä¸ºbeançš„å·¥å‚</span></span><br><span class=\"line\"><span class=\"meta\">@EnableConfigurationProperties(SmsProperties.class)</span> <span class=\"comment\">//ä½¿@ConfigurationPropertiesæ³¨è§£ç”Ÿæ•ˆ</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">SmsAutoConfiguration</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> SmsService <span class=\"title\">getBean</span><span class=\"params\">(SmsProperties smsProperties)</span></span>&#123;</span><br><span class=\"line\">        SmsService smsService = <span class=\"keyword\">new</span> SmsService(smsProperties);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> smsService;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h1 id=\"é™†ã€è‡ªåŠ¨è£…é…\"><a href=\"#é™†ã€è‡ªåŠ¨è£…é…\" class=\"headerlink\" title=\"é™†ã€è‡ªåŠ¨è£…é…\"></a>é™†ã€è‡ªåŠ¨è£…é…</h1><p>è¿™é‡Œä¼šç”¨åˆ°ç±»ä¼¼javaçš„SPIæœºåˆ¶ã€‚åœ¨èµ„æºåŒ…ä¸‹æ–°å»ºMETA-INF/spring.factorieså†™å…¥SmsAutoConfigurationå…¨é™å®šåã€‚è¿™æ ·åœ¨starterç»„ä»¶é›†æˆå…¥Spring Bootåº”ç”¨æ—¶å°±å¯ä»¥è¢«åº”ç”¨æ•æ‰åˆ°ã€‚  </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">org.springframework.boot.autoconfigure.EnableAutoConfiguration&#x3D;com.eelve.sms.starter.config.SmsAutoConfiguration</span><br></pre></td></tr></table></figure>\n<p>è¿™é‡Œè¿˜æœ‰å¦å¤–ä¸€ç§æ–¹å¼ï¼š</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Target(ElementType.TYPE)</span></span><br><span class=\"line\"><span class=\"meta\">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class=\"line\"><span class=\"meta\">@Documented</span></span><br><span class=\"line\"><span class=\"meta\">@Import(SmsAutoConfiguration.class)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> EnableSMS &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">//è¿™æ ·æˆ‘ä»¬ä½¿ç”¨EnableSMSæ³¨è§£ï¼Œå°±å¯ä»¥ä½¿ç”¨èƒ½åŠ›äº†</span></span><br></pre></td></tr></table></figure>\n<p>åˆ°è¿™é‡Œæˆ‘ä»¬çš„è‡ªå®šä¹‰é…ç½®å°±å¯ä»¥å®Œæˆäº†ï¼Œç„¶åå°±å¯ä»¥ä¸Šä¼ ä»“åº“ï¼Œæä¾›ç»™ç¬¬ä¸‰æ–¹ä½¿ç”¨äº†ã€‚</p>\n<h1 id=\"æŸ’ã€æµ‹è¯•\"><a href=\"#æŸ’ã€æµ‹è¯•\" class=\"headerlink\" title=\"æŸ’ã€æµ‹è¯•\"></a>æŸ’ã€æµ‹è¯•</h1><h2 id=\"7-1-åŠ å…¥sms-spring-boot-starterçŸ­ä¿¡ä¾èµ–\"><a href=\"#7-1-åŠ å…¥sms-spring-boot-starterçŸ­ä¿¡ä¾èµ–\" class=\"headerlink\" title=\"7.1 åŠ å…¥sms-spring-boot-starterçŸ­ä¿¡ä¾èµ–\"></a>7.1 åŠ å…¥<strong>sms-spring-boot-starter</strong>çŸ­ä¿¡ä¾èµ–</h2><h2 id=\"7-2-ç¼–å†™é…ç½®\"><a href=\"#7-2-ç¼–å†™é…ç½®\" class=\"headerlink\" title=\"7.2 ç¼–å†™é…ç½®\"></a>7.2 ç¼–å†™é…ç½®</h2><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">ucpaassms-config:</span></span><br><span class=\"line\">  <span class=\"attr\">account-sid:</span>  <span class=\"string\">//è¿™é‡Œå¡«å†™å¹³å°è·å–çš„IDå’ŒKEY</span></span><br><span class=\"line\">  <span class=\"attr\">auth-token:</span>   <span class=\"string\">//è¿™é‡Œå¡«å†™å¹³å°è·å–çš„IDå’ŒKEY</span></span><br><span class=\"line\">  <span class=\"attr\">appid:</span>        <span class=\"string\">//è¿™é‡Œå¡«å†™å¹³å°è·å–çš„IDå’ŒKEY</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"7-3-ç¼–å†™æµ‹è¯•ç±»\"><a href=\"#7-3-ç¼–å†™æµ‹è¯•ç±»\" class=\"headerlink\" title=\"7.3 ç¼–å†™æµ‹è¯•ç±»\"></a>7.3 ç¼–å†™æµ‹è¯•ç±»</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.eelve.ucpaassms.controller;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.eelve.sms.starter.SmsService;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.eelve.sms.starter.dto.SendSMSDTO;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.bind.annotation.RequestMethod;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@RestController</span></span><br><span class=\"line\"><span class=\"meta\">@RequestMapping(&quot;/sms&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TestController</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> SmsService smsService;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@RequestMapping(value = &quot;/sendsmsTest&quot;,method = RequestMethod.GET)</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">sendsmsTest</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">//åˆ›å»ºä¼ è¾“ç±»è®¾ç½®å‚æ•°</span></span><br><span class=\"line\">        SendSMSDTO sendSMSDTO  = <span class=\"keyword\">new</span> SendSMSDTO();</span><br><span class=\"line\">        sendSMSDTO.setMobile(<span class=\"string\">&quot;18888888888&quot;</span>);     <span class=\"comment\">//æ‰‹æœºå·</span></span><br><span class=\"line\">        sendSMSDTO.setTemplateid(<span class=\"string\">&quot;55555&quot;</span>); <span class=\"comment\">//æ¨¡æ¿</span></span><br><span class=\"line\">        sendSMSDTO.setParam(<span class=\"string\">&quot;9999&quot;</span>);      <span class=\"comment\">//å‚æ•°</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> smsService.sendSMS(sendSMSDTO);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>ç„¶åè¿è¡Œï¼Œè®¿é—®<a href=\"http://localhost:8080/sms/sendsmsTest\">http://localhost:8080/sms/sendsmsTest</a>,å°±å¯ä»¥æ”¶åˆ°å‘é€çš„çŸ­ä¿¡äº†</p>\n<pre><code>ã€è”šç„¶å±±åº„ã€‘å°Šæ•¬çš„ç”¨æˆ·ï¼Œæ•¬è¯·å…³æ³¨æˆ‘ä»¬çš„åç»­æ´»åŠ¨ã€‚\n</code></pre>\n<hr>\n<p>ã€<strong>åé¢çš„è¯</strong>ã€‘</p>\n<p>åœ¨å¼•å…¥è‡ªå·±å°è£…çš„Starterçš„æ—¶å€™,æœ‰çš„äººä¼šæŠ¥é”™xxxxç±»çš„beanæ²¡æœ‰æ‰¾åˆ°é—®é¢˜,æ˜¯å› ä¸º@SpringBootApplicationæ‰«æåŒ…çš„èŒƒå›´æ˜¯å¯åŠ¨ç±»æ‰€åœ¨åŒçº§åŒ…å’Œå­åŒ…,ä½†æ˜¯ä¸åŒ…æ‹¬ç¬¬ä¸‰æ–¹çš„jaråŒ….å¦‚æœéœ€è¦æ‰«æmavenä¾èµ–æ·»åŠ çš„Jar,æˆ‘ä»¬å°±è¦å•ç‹¬ä½¿ç”¨@ComponentScanæ³¨è§£æ‰«æåŒ….<br>é’ˆå¯¹è¿™ç§æƒ…å†µè§£å†³æ–¹å¼æœ‰ä¸¤ç§:</p>\n<p>ç¬¬ä¸€ç§:æ˜¯ä½ å°è£…çš„Starteré¡¹ç›®ä¸‹çˆ¶çº§åŒ…åç§°å’Œæµ‹è¯•é¡¹ç›®çš„çˆ¶çº§åŒ…åä¸€æ ·,ä¾‹å¦‚è¿™ä¸¤ä¸ªé¡¹ç›®åŒ…åéƒ½å«com.eelve,è¿™æ ·å¯ä»¥ä¸ä½¿ç”¨@ComponentScanæ³¨è§£,å¾ˆæ˜¾ç„¶è¿™æ ·åšæœ‰å±€é™æ€§,ä¸æ¨è.</p>\n<p>ç¬¬äºŒç§:æ˜¯å¯ä»¥å•ç‹¬ä½¿ç”¨@ComponentScanæ³¨è§£æ‰«æç¬¬ä¸‰æ–¹åŒ…,ä½†æ˜¯è¿™é‡Œä¸€å®šè¦æ³¨æ„@SpringBootApplicationæ³¨è§£ç­‰ä»·äºé»˜è®¤å±æ€§ä½¿ç”¨@Configuration+@EnableAutoConfiguration+@ComponentScan,å¦‚æœ@SpringBootApplicationå’Œ@ComponentScanæ³¨è§£åŒæ—¶å­˜åœ¨ï¼Œé‚£ä¹ˆ@SpringBootApplicationæ³¨è§£ä¸­@ComponentScançš„æ‰«æèŒƒå›´ä¼šè¢«è¦†ç›–,æ‰€ä»¥å•ç‹¬ä½¿ç”¨@ComponentScançš„è¯,å¿…é¡»åœ¨è¯¥æ³¨è§£ä¸Šé…ç½®é¡¹ç›®éœ€è¦æ‰«æçš„åŒ…çš„æ‰€æœ‰èŒƒå›´,å³é¡¹ç›®åŒ…è·¯å¾„+ä¾èµ–åŒ…è·¯å¾„.</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">/**</span></span><br><span class=\"line\"> <span class=\"string\">*</span> <span class=\"string\">@ComponentScanæ³¨è§£æ‰«æå¤šä¸ªåŒ…ä¸‹ç¤ºä¾‹</span></span><br><span class=\"line\"> <span class=\"string\">*/</span></span><br><span class=\"line\"><span class=\"string\">@ComponentScan(&#123;&quot;com.test&quot;,&quot;sms.test&quot;&#125;)</span></span><br></pre></td></tr></table></figure>\n<p>å¦å¤–å…·ä½“å®ç°å¯ä»¥å‚è€ƒæˆ‘çš„é¡¹ç›®ï¼š<a href=\"https://github.com/eelve/ucpaas-spring-boot-starter\">ucpaas-spring-boot-starter</a></p>\n<hr>\n<p><img src=\"https://image.eelve.com/eblog/eblog-b269767ff45b4e01a1c380e38898c1c0.png\" alt=\"è–ç±³ç¬”è®°\"></p>\n","raw":null,"categories":[{"name":"SpringBoot","path":"api/categories/SpringBoot.json"}],"tags":[{"name":"java","path":"api/tags/java.json"},{"name":"springboot","path":"api/tags/springboot.json"}]}]}Œå…¶å® Spring Boot Admin ä¹Ÿç»™å‡ºäº†æ”¯æŒã€‚</p>\n<p>æˆ‘ä»¬å¯¹ä¸Šé¢çš„ç¤ºä¾‹é¡¹ç›® spring-boot-admin-server è¿›è¡Œæ”¹é€ ã€‚</p>\n<h2 id=\"æ·»åŠ ä¾èµ–\"><a href=\"#æ·»åŠ ä¾èµ–\" class=\"headerlink\" title=\"æ·»åŠ ä¾èµ–\"></a>æ·»åŠ ä¾èµ–</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;dependency&gt;</span><br><span class=\"line\">  &lt;groupId&gt;org.springframework.boot&lt;&#x2F;groupId&gt;</span><br><span class=\"line\">  &lt;artifactId&gt;spring-boot-starter-mail&lt;&#x2F;artifactId&gt;</span><br><span class=\"line\">&lt;&#x2F;dependency&gt;</span><br></pre></td></tr></table></figure>\n<h2 id=\"å¢åŠ äº†é‚®ä»¶å‘é€çš„-starter-åŒ…ã€‚\"><a href=\"#å¢åŠ äº†é‚®ä»¶å‘é€çš„-starter-åŒ…ã€‚\" class=\"headerlink\" title=\"å¢åŠ äº†é‚®ä»¶å‘é€çš„ starter åŒ…ã€‚\"></a>å¢åŠ äº†é‚®ä»¶å‘é€çš„ starter åŒ…ã€‚</h2><h3 id=\"é…ç½®æ–‡ä»¶-2\"><a href=\"#é…ç½®æ–‡ä»¶-2\" class=\"headerlink\" title=\"é…ç½®æ–‡ä»¶\"></a>é…ç½®æ–‡ä»¶</h3><figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">spring.mail.host</span>=<span class=\"string\">smtp.qq.com</span></span><br><span class=\"line\"><span class=\"meta\">spring.mail.username</span>=<span class=\"string\">xxx@qq.com</span></span><br><span class=\"line\"><span class=\"meta\">spring.mail.password</span>=<span class=\"string\">xxx</span></span><br><span class=\"line\"><span class=\"meta\">spring.mail.properties.mail.smtp.auth</span>=<span class=\"string\">true</span></span><br><span class=\"line\"><span class=\"meta\">spring.mail.properties.mail.smtp.starttls.enable</span>=<span class=\"string\">true</span></span><br><span class=\"line\"><span class=\"meta\">spring.mail.properties.mail.smtp.starttls.required</span>=<span class=\"string\">true</span></span><br><span class=\"line\"><span class=\"meta\">spring.boot.admin.notify.mail.from</span>=<span class=\"string\">yyyy@qq.com</span></span><br><span class=\"line\"><span class=\"meta\">spring.boot.admin.notify.mail.to</span>=<span class=\"string\">zzz@qq.com</span></span><br></pre></td></tr></table></figure>\n<p><strong>åœ¨é…ç½®æ–‡ä»¶ä¸­æ·»åŠ é‚®ä»¶å‘é€ç›¸å…³ä¿¡æ¯ï¼šé‚®ä»¶çš„å‘é€è€…ã€æ¥å—è€…ã€åè®®ã€ç§»åŠ¨æˆæƒç ç­‰</strong>ã€‚</p>\n<p>é…ç½®å®Œæˆåï¼Œé‡æ–°å¯åŠ¨é¡¹ç›® spring-boot-admin-serverï¼Œè¿™æ · Admin Server å°±å…·å¤‡äº†é‚®ä»¶å‘Šè­¦çš„åŠŸèƒ½ï¼Œé»˜è®¤æƒ…å†µä¸‹ Admin Server å¯¹ Eureka ä¸­çš„æœåŠ¡ä¸Šä¸‹çº¿éƒ½è¿›è¡Œäº†ç›‘æ§ï¼Œå½“æœåŠ¡ä¸Šä¸‹çº¿çš„æ—¶å€™æˆ‘ä»¬å°±ä¼šæ”¶åˆ°ç›¸åº”çš„å‘Šè­¦é‚®ä»¶ã€‚</p>\n<p>å½“ç„¶è¿™åªæ˜¯æœ€åŸºæœ¬çš„é‚®ä»¶ç›‘æ§ï¼Œåœ¨å®é™…çš„ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œéœ€è¦æ ¹æ®æƒ…å†µå¯¹é‚®ä»¶å‘Šè­¦å†…å®¹è¿›è¡Œè‡ªå®šä¹‰ï¼Œæ¯”å¦‚ç›‘æ§å †å†…å­˜çš„ä½¿ç”¨æƒ…å†µï¼Œå½“åˆ°è¾¾ä¸€å®šæ¯”ä¾‹çš„æ—¶å€™è¿›è¡Œå‘Šè­¦ç­‰ã€‚</p>\n<p>ã€å†™åœ¨åé¢çš„è¯ã€‘Spring Boot Admin è§£å†³äº†æˆ‘ä»¬å¯¹å¤§è§„æ¨¡ Spring Boot åº”ç”¨ç›‘æ§çš„éœ€æ±‚ï¼ŒSpring Boot Admin å……åˆ†åˆ©ç”¨äº† Actuator å¼€æ”¾çš„ç›¸å…³æ¥å£ï¼Œé‡‡ç”¨ä¼˜ç§€çš„å›¾å½¢ç•Œé¢å°†è¿™äº›ä¿¡æ¯è¿›è¡Œäº†å±•ç¤ºï¼Œæ–¹ä¾¿æˆ‘ä»¬æ›´åŠ ç›´è§‚çš„æŸ¥çœ‹é›†ç¾¤ä¸­åº”ç”¨çš„çŠ¶æ€ã€‚Spring Boot Admin ä¸ä»…å¯ä»¥ç›‘æ§å•ä¸ª Spring Boot åº”ç”¨ï¼Œä¹Ÿå¯ä»¥ç»“åˆ Spring Cloud ç›‘æ§æ³¨å†Œåˆ°æœåŠ¡ä¸­å¿ƒçš„æ‰€æœ‰åº”ç”¨çŠ¶æ€ï¼Œå†ç»“åˆæŠ¥è­¦ç³»ç»Ÿçš„ä½¿ç”¨å°±å¯ä»¥éšæ—¶æ„ŸçŸ¥åˆ°åº”ç”¨çš„çŠ¶æ€å˜åŒ–ã€‚åœ¨å®é™…å·¥ä½œä¸­ Spring Boot Admin æ˜¯æˆ‘ä»¬åœ¨åæœŸè¿è¥ä¸­é¢‘ç¹ç”¨åˆ°çš„ä¸€ä¸ªç»„ä»¶ï¼Œåº”è¯¥ä½œä¸ºé‡ç‚¹å…³æ³¨ã€‚</p>\n<hr>\n<p>æœ€åæ˜¯ä¸€ä¸ªç”¨httpæ–¹å¼ç›‘å¬çš„demoï¼š<a href=\"https://github.com/eelve/springbootadmin\">Spring Boot Adminä½¿ç”¨httpè¿æ¥serverç«¯</a></p>\n<hr>\n<p><img src=\"https://image.eelve.com/eblog/eblog-b269767ff45b4e01a1c380e38898c1c0.png\" alt=\"è–ç±³ç¬”è®°\"></p>\n","raw":null,"categories":[{"name":"springboot","path":"api/categories/springboot.json"}],"tags":[{"name":"java","path":"api/tags/java.json"},{"name":"springboot","path":"api/tags/springboot.json"},{"name":"springboot-admin","path":"api/tags/springboot-admin.json"}]},{"title":"spring-boot-starter-quartzé›†ç¾¤å®è·µ","slug":"spring-boot-starter-quartzé›†ç¾¤å®è·µ","date":"2019-08-09T09:06:12.000Z","updated":"2021-04-19T06:44:39.180Z","comments":true,"path":"api/articles/spring-boot-starter-quartzé›†ç¾¤å®è·µ.json","excerpt":null,"keywords":"å—å›½è–ç±³","cover":"https://image.eelve.com/eblog/1-a8a710a578ad47a8afc8ace72f3cbd7c.png","content":"<p>ã€<strong>å‰æƒ…æè¦</strong>ã€‘ç”±äºé¡¹ç›®éœ€è¦ï¼Œéœ€è¦ä¸€ä¸ªå®šæ—¶ä»»åŠ¡é›†ç¾¤ï¼Œæ•…æ­¤æœ‰äº†è¿™ä¸ªspring-boot-starter-quartzé›†ç¾¤çš„å®è·µã€‚springbootçš„ç‰ˆæœ¬ä¸ºï¼š2.1.6.RELEASEï¼›quartzçš„ç‰ˆæœ¬ä¸ºï¼š2.3.1.å‡å¦‚è¿™é‡Œä¸€å…±æœ‰ä¸¤ä¸ªå®šæ—¶ä»»åŠ¡çš„èŠ‚ç‚¹ï¼Œå®ƒä»¬çš„ä»£ç å®Œå…¨ä¸€æ ·ã€‚</p>\n<hr>\n<h1 id=\"å£¹-jaråŒ…ä¾èµ–\"><a href=\"#å£¹-jaråŒ…ä¾èµ–\" class=\"headerlink\" title=\"å£¹.jaråŒ…ä¾èµ–\"></a>å£¹.jaråŒ…ä¾èµ–</h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;properties&gt;</span><br><span class=\"line\">        &lt;java.version&gt;1.8&lt;&#x2F;java.version&gt;</span><br><span class=\"line\">    &lt;&#x2F;properties&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">    &lt;dependencies&gt;</span><br><span class=\"line\">        &lt;dependency&gt;</span><br><span class=\"line\">            &lt;groupId&gt;org.springframework.boot&lt;&#x2F;groupId&gt;</span><br><span class=\"line\">            &lt;artifactId&gt;spring-boot-starter&lt;&#x2F;artifactId&gt;</span><br><span class=\"line\">        &lt;&#x2F;dependency&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">        &lt;dependency&gt;</span><br><span class=\"line\">            &lt;groupId&gt;org.springframework.boot&lt;&#x2F;groupId&gt;</span><br><span class=\"line\">            &lt;artifactId&gt;spring-boot-starter-quartz&lt;&#x2F;artifactId&gt;</span><br><span class=\"line\">        &lt;&#x2F;dependency&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">        &lt;dependency&gt;</span><br><span class=\"line\">            &lt;groupId&gt;mysql&lt;&#x2F;groupId&gt;</span><br><span class=\"line\">            &lt;artifactId&gt;mysql-connector-java&lt;&#x2F;artifactId&gt;</span><br><span class=\"line\">            &lt;scope&gt;runtime&lt;&#x2F;scope&gt;</span><br><span class=\"line\">        &lt;&#x2F;dependency&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">        &lt;dependency&gt;</span><br><span class=\"line\">            &lt;groupId&gt;org.springframework.boot&lt;&#x2F;groupId&gt;</span><br><span class=\"line\">            &lt;artifactId&gt;spring-boot-starter-jdbc&lt;&#x2F;artifactId&gt;</span><br><span class=\"line\">        &lt;&#x2F;dependency&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">        &lt;dependency&gt;</span><br><span class=\"line\">            &lt;groupId&gt;org.projectlombok&lt;&#x2F;groupId&gt;</span><br><span class=\"line\">            &lt;artifactId&gt;lombok&lt;&#x2F;artifactId&gt;</span><br><span class=\"line\">            &lt;optional&gt;true&lt;&#x2F;optional&gt;</span><br><span class=\"line\">        &lt;&#x2F;dependency&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">        &lt;dependency&gt;</span><br><span class=\"line\">            &lt;groupId&gt;org.springframework.boot&lt;&#x2F;groupId&gt;</span><br><span class=\"line\">            &lt;artifactId&gt;spring-boot-starter-test&lt;&#x2F;artifactId&gt;</span><br><span class=\"line\">            &lt;scope&gt;test&lt;&#x2F;scope&gt;</span><br><span class=\"line\">        &lt;&#x2F;dependency&gt;</span><br><span class=\"line\">    &lt;&#x2F;dependencies&gt;</span><br></pre></td></tr></table></figure>\n<p>è¿™é‡Œé€‰æ‹©å°†å®šæ—¶ä»»åŠ¡çš„æ•°æ®å…¥åº“ï¼Œé¿å…æ•°æ®ç›´æ¥å­˜åœ¨å†…å­˜ä¸­ï¼Œå› åº”ç”¨é‡å¯é€ æˆçš„æ•°æ®ä¸¢å¤±å’Œåšé›†ç¾¤æ§åˆ¶ã€‚</p>\n<h1 id=\"è´°ã€é¡¹ç›®é…ç½®\"><a href=\"#è´°ã€é¡¹ç›®é…ç½®\" class=\"headerlink\" title=\"è´°ã€é¡¹ç›®é…ç½®\"></a>è´°ã€é¡¹ç›®é…ç½®</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">spring:</span></span><br><span class=\"line\">  <span class=\"attr\">server:</span></span><br><span class=\"line\">    <span class=\"attr\">port:</span> <span class=\"number\">8080</span></span><br><span class=\"line\">    <span class=\"attr\">servlet:</span></span><br><span class=\"line\">      <span class=\"attr\">context-path:</span> <span class=\"string\">/lovin</span></span><br><span class=\"line\">  <span class=\"attr\">datasource:</span></span><br><span class=\"line\">    <span class=\"attr\">url:</span> <span class=\"string\">jdbc:mysql://127.0.0.1:3306/training?serverTimezone=UTC&amp;useUnicode=true&amp;characterEncoding=utf-8&amp;useSSL=true</span></span><br><span class=\"line\">    <span class=\"attr\">username:</span> <span class=\"string\">root</span></span><br><span class=\"line\">    <span class=\"attr\">password:</span> <span class=\"string\">root</span></span><br><span class=\"line\">    <span class=\"attr\">driver-class-name:</span> <span class=\"string\">com.mysql.cj.jdbc.Driver</span></span><br><span class=\"line\">  <span class=\"attr\">quartz:</span></span><br><span class=\"line\">    <span class=\"attr\">job-store-type:</span> <span class=\"string\">jdbc</span> <span class=\"comment\">#æ•°æ®åº“æ–¹å¼</span></span><br><span class=\"line\">    <span class=\"attr\">jdbc:</span></span><br><span class=\"line\">      <span class=\"attr\">initialize-schema:</span> <span class=\"string\">never</span> <span class=\"comment\">#ä¸åˆå§‹åŒ–è¡¨ç»“æ„</span></span><br><span class=\"line\">    <span class=\"attr\">properties:</span></span><br><span class=\"line\">      <span class=\"attr\">org:</span></span><br><span class=\"line\">        <span class=\"attr\">quartz:</span></span><br><span class=\"line\">          <span class=\"attr\">scheduler:</span></span><br><span class=\"line\">            <span class=\"attr\">instanceId:</span> <span class=\"string\">AUTO</span> <span class=\"comment\">#é»˜è®¤ä¸»æœºåå’Œæ—¶é—´æˆ³ç”Ÿæˆå®ä¾‹ID,å¯ä»¥æ˜¯ä»»ä½•å­—ç¬¦ä¸²ï¼Œä½†å¯¹äºæ‰€æœ‰è°ƒåº¦ç¨‹åºæ¥è¯´ï¼Œå¿…é¡»æ˜¯å”¯ä¸€çš„ å¯¹åº”qrtz_scheduler_state INSTANCE_NAMEå­—æ®µ</span></span><br><span class=\"line\">            <span class=\"comment\">#instanceName: clusteredScheduler #quartzScheduler</span></span><br><span class=\"line\">          <span class=\"attr\">jobStore:</span></span><br><span class=\"line\">            <span class=\"attr\">class:</span> <span class=\"string\">org.quartz.impl.jdbcjobstore.JobStoreTX</span> <span class=\"comment\">#æŒä¹…åŒ–é…ç½®</span></span><br><span class=\"line\">            <span class=\"attr\">driverDelegateClass:</span> <span class=\"string\">org.quartz.impl.jdbcjobstore.StdJDBCDelegate</span> <span class=\"comment\">#æˆ‘ä»¬ä»…ä¸ºæ•°æ®åº“åˆ¶ä½œäº†ç‰¹å®šäºæ•°æ®åº“çš„ä»£ç†</span></span><br><span class=\"line\">            <span class=\"attr\">useProperties:</span> <span class=\"literal\">false</span> <span class=\"comment\">#ä»¥æŒ‡ç¤ºJDBCJobStoreå°†JobDataMapsä¸­çš„æ‰€æœ‰å€¼éƒ½ä½œä¸ºå­—ç¬¦ä¸²ï¼Œå› æ­¤å¯ä»¥ä½œä¸ºåç§° - å€¼å¯¹å­˜å‚¨è€Œä¸æ˜¯åœ¨BLOBåˆ—ä¸­ä»¥å…¶åºåˆ—åŒ–å½¢å¼å­˜å‚¨æ›´å¤šå¤æ‚çš„å¯¹è±¡ã€‚ä»é•¿è¿œæ¥çœ‹ï¼Œè¿™æ˜¯æ›´å®‰å…¨çš„ï¼Œå› ä¸ºæ‚¨é¿å…äº†å°†éStringç±»åºåˆ—åŒ–ä¸ºBLOBçš„ç±»ç‰ˆæœ¬é—®é¢˜ã€‚</span></span><br><span class=\"line\">            <span class=\"attr\">tablePrefix:</span> <span class=\"string\">qrtz_</span>  <span class=\"comment\">#æ•°æ®åº“è¡¨å‰ç¼€</span></span><br><span class=\"line\">            <span class=\"attr\">misfireThreshold:</span> <span class=\"number\">60000</span> <span class=\"comment\">#åœ¨è¢«è®¤ä¸ºâ€œå¤±ç«â€ä¹‹å‰ï¼Œè°ƒåº¦ç¨‹åºå°†â€œå®¹å¿â€ä¸€ä¸ªTriggerså°†å…¶ä¸‹ä¸€ä¸ªå¯åŠ¨æ—¶é—´é€šè¿‡çš„æ¯«ç§’æ•°ã€‚é»˜è®¤å€¼ï¼ˆå¦‚æœæ‚¨åœ¨é…ç½®ä¸­æœªè¾“å…¥æ­¤å±æ€§ï¼‰ä¸º60000ï¼ˆ60ç§’ï¼‰ã€‚</span></span><br><span class=\"line\">            <span class=\"attr\">clusterCheckinInterval:</span> <span class=\"number\">5000</span> <span class=\"comment\">#è®¾ç½®æ­¤å®ä¾‹â€œæ£€å…¥â€*ä¸ç¾¤é›†çš„å…¶ä»–å®ä¾‹çš„é¢‘ç‡ï¼ˆä»¥æ¯«ç§’ä¸ºå•ä½ï¼‰ã€‚å½±å“æ£€æµ‹å¤±è´¥å®ä¾‹çš„é€Ÿåº¦ã€‚</span></span><br><span class=\"line\">            <span class=\"attr\">isClustered:</span> <span class=\"literal\">true</span> <span class=\"comment\">#æ‰“å¼€ç¾¤é›†åŠŸèƒ½</span></span><br><span class=\"line\">          <span class=\"attr\">threadPool:</span> <span class=\"comment\">#è¿æ¥æ± </span></span><br><span class=\"line\">            <span class=\"attr\">class:</span> <span class=\"string\">org.quartz.simpl.SimpleThreadPool</span></span><br><span class=\"line\">            <span class=\"attr\">threadCount:</span> <span class=\"number\">10</span></span><br><span class=\"line\">            <span class=\"attr\">threadPriority:</span> <span class=\"number\">5</span></span><br><span class=\"line\">            <span class=\"attr\">threadsInheritContextClassLoaderOfInitializingThread:</span> <span class=\"literal\">true</span></span><br></pre></td></tr></table></figure>\n<p><strong>è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ä¸¤ä¸ªèŠ‚ç‚¹çš„ç«¯å£å·åº”è¯¥ä¸ä¸€è‡´ï¼Œé¿å…å†²çª</strong></p>\n<h1 id=\"åã€å®ç°ä¸€ä¸ªJob\"><a href=\"#åã€å®ç°ä¸€ä¸ªJob\" class=\"headerlink\" title=\"åã€å®ç°ä¸€ä¸ªJob\"></a>åã€å®ç°ä¸€ä¸ªJob</h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Job</span> <span class=\"keyword\">extends</span> <span class=\"title\">QuartzJobBean</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">executeInternal</span><span class=\"params\">(JobExecutionContext jobExecutionContext)</span> <span class=\"keyword\">throws</span> JobExecutionException </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// è·å–å‚æ•°</span></span><br><span class=\"line\">        JobDataMap jobDataMap = jobExecutionContext.getJobDetail().getJobDataMap();</span><br><span class=\"line\">        <span class=\"comment\">// ä¸šåŠ¡é€»è¾‘ ...</span></span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;------springbootquartzonejobæ‰§è¡Œ&quot;</span>+jobDataMap.get(<span class=\"string\">&quot;name&quot;</span>).toString()+<span class=\"string\">&quot;###############&quot;</span>+jobExecutionContext.getTrigger());</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n<p><strong>å…¶ä¸­çš„æ—¥å¿—è¾“å‡ºæ˜¯ä¸ºäº†ä¾¿äºè§‚å¯Ÿä»»åŠ¡æ‰§è¡Œæƒ…å†µ</strong></p>\n<h1 id=\"è‚†ã€å°è£…å®šæ—¶ä»»åŠ¡æ“ä½œ\"><a href=\"#è‚†ã€å°è£…å®šæ—¶ä»»åŠ¡æ“ä½œ\" class=\"headerlink\" title=\"è‚†ã€å°è£…å®šæ—¶ä»»åŠ¡æ“ä½œ\"></a>è‚†ã€å°è£…å®šæ—¶ä»»åŠ¡æ“ä½œ</h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br><span class=\"line\">194</span><br><span class=\"line\">195</span><br><span class=\"line\">196</span><br><span class=\"line\">197</span><br><span class=\"line\">198</span><br><span class=\"line\">199</span><br><span class=\"line\">200</span><br><span class=\"line\">201</span><br><span class=\"line\">202</span><br><span class=\"line\">203</span><br><span class=\"line\">204</span><br><span class=\"line\">205</span><br><span class=\"line\">206</span><br><span class=\"line\">207</span><br><span class=\"line\">208</span><br><span class=\"line\">209</span><br><span class=\"line\">210</span><br><span class=\"line\">211</span><br><span class=\"line\">212</span><br><span class=\"line\">213</span><br><span class=\"line\">214</span><br><span class=\"line\">215</span><br><span class=\"line\">216</span><br><span class=\"line\">217</span><br><span class=\"line\">218</span><br><span class=\"line\">219</span><br><span class=\"line\">220</span><br><span class=\"line\">221</span><br><span class=\"line\">222</span><br><span class=\"line\">223</span><br><span class=\"line\">224</span><br><span class=\"line\">225</span><br><span class=\"line\">226</span><br><span class=\"line\">227</span><br><span class=\"line\">228</span><br><span class=\"line\">229</span><br><span class=\"line\">230</span><br><span class=\"line\">231</span><br><span class=\"line\">232</span><br><span class=\"line\">233</span><br><span class=\"line\">234</span><br><span class=\"line\">235</span><br><span class=\"line\">236</span><br><span class=\"line\">237</span><br><span class=\"line\">238</span><br><span class=\"line\">239</span><br><span class=\"line\">240</span><br><span class=\"line\">241</span><br><span class=\"line\">242</span><br><span class=\"line\">243</span><br><span class=\"line\">244</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Service</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">QuartzService</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Scheduler scheduler;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@PostConstruct</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">startScheduler</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            scheduler.start();</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (SchedulerException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * å¢åŠ ä¸€ä¸ªjob</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> jobClass</span></span><br><span class=\"line\"><span class=\"comment\">     *            ä»»åŠ¡å®ç°ç±»</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> jobName</span></span><br><span class=\"line\"><span class=\"comment\">     *            ä»»åŠ¡åç§°</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> jobGroupName</span></span><br><span class=\"line\"><span class=\"comment\">     *            ä»»åŠ¡ç»„å</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> jobTime</span></span><br><span class=\"line\"><span class=\"comment\">     *            æ—¶é—´è¡¨è¾¾å¼ (è¿™æ˜¯æ¯éš”å¤šå°‘ç§’ä¸ºä¸€æ¬¡ä»»åŠ¡)</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> jobTimes</span></span><br><span class=\"line\"><span class=\"comment\">     *            è¿è¡Œçš„æ¬¡æ•° ï¼ˆ&lt;0:è¡¨ç¤ºä¸é™æ¬¡æ•°ï¼‰</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> jobData</span></span><br><span class=\"line\"><span class=\"comment\">     *            å‚æ•°</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">addJob</span><span class=\"params\">(Class&lt;? extends QuartzJobBean&gt; jobClass, String jobName, String jobGroupName, <span class=\"keyword\">int</span> jobTime,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">                       <span class=\"keyword\">int</span> jobTimes, Map jobData)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// ä»»åŠ¡åç§°å’Œç»„æ„æˆä»»åŠ¡key</span></span><br><span class=\"line\">            JobDetail jobDetail = JobBuilder.newJob(jobClass).withIdentity(jobName, jobGroupName)</span><br><span class=\"line\">                    .build();</span><br><span class=\"line\">            <span class=\"comment\">// è®¾ç½®jobå‚æ•°</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span>(jobData!= <span class=\"keyword\">null</span> &amp;&amp; jobData.size()&gt;<span class=\"number\">0</span>)&#123;</span><br><span class=\"line\">                jobDetail.getJobDataMap().putAll(jobData);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"comment\">// ä½¿ç”¨simpleTriggerè§„åˆ™</span></span><br><span class=\"line\">            Trigger trigger = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (jobTimes &lt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">                trigger = TriggerBuilder.newTrigger().withIdentity(jobName, jobGroupName)</span><br><span class=\"line\">                        .withSchedule(SimpleScheduleBuilder.repeatSecondlyForever(<span class=\"number\">1</span>).withIntervalInSeconds(jobTime))</span><br><span class=\"line\">                        .startNow().build();</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                trigger = TriggerBuilder</span><br><span class=\"line\">                        .newTrigger().withIdentity(jobName, jobGroupName).withSchedule(SimpleScheduleBuilder</span><br><span class=\"line\">                                .repeatSecondlyForever(<span class=\"number\">1</span>).withIntervalInSeconds(jobTime).withRepeatCount(jobTimes))</span><br><span class=\"line\">                        .startNow().build();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            scheduler.scheduleJob(jobDetail, trigger);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (SchedulerException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * å¢åŠ ä¸€ä¸ªjob</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> jobClass</span></span><br><span class=\"line\"><span class=\"comment\">     *            ä»»åŠ¡å®ç°ç±»</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> jobName</span></span><br><span class=\"line\"><span class=\"comment\">     *            ä»»åŠ¡åç§°(å»ºè®®å”¯ä¸€)</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> jobGroupName</span></span><br><span class=\"line\"><span class=\"comment\">     *            ä»»åŠ¡ç»„å</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> jobTime</span></span><br><span class=\"line\"><span class=\"comment\">     *            æ—¶é—´è¡¨è¾¾å¼ ï¼ˆå¦‚ï¼š0/5 * * * * ? ï¼‰</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> jobData</span></span><br><span class=\"line\"><span class=\"comment\">     *            å‚æ•°</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">addJob</span><span class=\"params\">(Class&lt;? extends QuartzJobBean&gt; jobClass, String jobName, String jobGroupName, String jobTime, Map jobData)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// åˆ›å»ºjobDetailå®ä¾‹ï¼Œç»‘å®šJobå®ç°ç±»</span></span><br><span class=\"line\">            <span class=\"comment\">// æŒ‡æ˜jobçš„åç§°ï¼Œæ‰€åœ¨ç»„çš„åç§°ï¼Œä»¥åŠç»‘å®šjobç±»</span></span><br><span class=\"line\">            <span class=\"comment\">// ä»»åŠ¡åç§°å’Œç»„æ„æˆä»»åŠ¡key</span></span><br><span class=\"line\">            JobDetail jobDetail = JobBuilder.newJob(jobClass).withIdentity(jobName, jobGroupName)</span><br><span class=\"line\">                    .build();</span><br><span class=\"line\">            <span class=\"comment\">// è®¾ç½®jobå‚æ•°</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span>(jobData!= <span class=\"keyword\">null</span> &amp;&amp; jobData.size()&gt;<span class=\"number\">0</span>)&#123;</span><br><span class=\"line\">                jobDetail.getJobDataMap().putAll(jobData);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"comment\">// å®šä¹‰è°ƒåº¦è§¦å‘è§„åˆ™</span></span><br><span class=\"line\">            <span class=\"comment\">// ä½¿ç”¨cornTriggerè§„åˆ™</span></span><br><span class=\"line\">            <span class=\"comment\">// è§¦å‘å™¨key</span></span><br><span class=\"line\">            Trigger trigger = TriggerBuilder.newTrigger().withIdentity(jobName, jobGroupName)</span><br><span class=\"line\">                    .startAt(DateBuilder.futureDate(<span class=\"number\">1</span>, IntervalUnit.SECOND))</span><br><span class=\"line\">                    .withSchedule(CronScheduleBuilder.cronSchedule(jobTime)).startNow().build();</span><br><span class=\"line\">            <span class=\"comment\">// æŠŠä½œä¸šå’Œè§¦å‘å™¨æ³¨å†Œåˆ°ä»»åŠ¡è°ƒåº¦ä¸­</span></span><br><span class=\"line\">            scheduler.scheduleJob(jobDetail, trigger);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * ä¿®æ”¹ ä¸€ä¸ªjobçš„ æ—¶é—´è¡¨è¾¾å¼</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> jobName</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> jobGroupName</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> jobTime</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">updateJob</span><span class=\"params\">(String jobName, String jobGroupName, String jobTime)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            TriggerKey triggerKey = TriggerKey.triggerKey(jobName, jobGroupName);</span><br><span class=\"line\">            CronTrigger trigger = (CronTrigger) scheduler.getTrigger(triggerKey);</span><br><span class=\"line\">            trigger = trigger.getTriggerBuilder().withIdentity(triggerKey)</span><br><span class=\"line\">                    .withSchedule(CronScheduleBuilder.cronSchedule(jobTime)).build();</span><br><span class=\"line\">            <span class=\"comment\">// é‡å¯è§¦å‘å™¨</span></span><br><span class=\"line\">            scheduler.rescheduleJob(triggerKey, trigger);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (SchedulerException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * åˆ é™¤ä»»åŠ¡ä¸€ä¸ªjob</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> jobName</span></span><br><span class=\"line\"><span class=\"comment\">     *            ä»»åŠ¡åç§°</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> jobGroupName</span></span><br><span class=\"line\"><span class=\"comment\">     *            ä»»åŠ¡ç»„å</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">deleteJob</span><span class=\"params\">(String jobName, String jobGroupName)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            scheduler.deleteJob(<span class=\"keyword\">new</span> JobKey(jobName, jobGroupName));</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * æš‚åœä¸€ä¸ªjob</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> jobName</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> jobGroupName</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">pauseJob</span><span class=\"params\">(String jobName, String jobGroupName)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            JobKey jobKey = JobKey.jobKey(jobName, jobGroupName);</span><br><span class=\"line\">            scheduler.pauseJob(jobKey);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (SchedulerException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * æ¢å¤ä¸€ä¸ªjob</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> jobName</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> jobGroupName</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">resumeJob</span><span class=\"params\">(String jobName, String jobGroupName)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            JobKey jobKey = JobKey.jobKey(jobName, jobGroupName);</span><br><span class=\"line\">            scheduler.resumeJob(jobKey);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (SchedulerException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * ç«‹å³æ‰§è¡Œä¸€ä¸ªjob</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> jobName</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> jobGroupName</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">runAJobNow</span><span class=\"params\">(String jobName, String jobGroupName)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            JobKey jobKey = JobKey.jobKey(jobName, jobGroupName);</span><br><span class=\"line\">            scheduler.triggerJob(jobKey);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (SchedulerException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * è·å–æ‰€æœ‰è®¡åˆ’ä¸­çš„ä»»åŠ¡åˆ—è¡¨</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> List&lt;Map&lt;String, Object&gt;&gt; queryAllJob() &#123;</span><br><span class=\"line\">        List&lt;Map&lt;String, Object&gt;&gt; jobList = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            GroupMatcher&lt;JobKey&gt; matcher = GroupMatcher.anyJobGroup();</span><br><span class=\"line\">            Set&lt;JobKey&gt; jobKeys = scheduler.getJobKeys(matcher);</span><br><span class=\"line\">            jobList = <span class=\"keyword\">new</span> ArrayList&lt;Map&lt;String, Object&gt;&gt;();</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (JobKey jobKey : jobKeys) &#123;</span><br><span class=\"line\">                List&lt;? extends Trigger&gt; triggers = scheduler.getTriggersOfJob(jobKey);</span><br><span class=\"line\">                <span class=\"keyword\">for</span> (Trigger trigger : triggers) &#123;</span><br><span class=\"line\">                    Map&lt;String, Object&gt; map = <span class=\"keyword\">new</span> HashMap&lt;&gt;();</span><br><span class=\"line\">                    map.put(<span class=\"string\">&quot;jobName&quot;</span>, jobKey.getName());</span><br><span class=\"line\">                    map.put(<span class=\"string\">&quot;jobGroupName&quot;</span>, jobKey.getGroup());</span><br><span class=\"line\">                    map.put(<span class=\"string\">&quot;description&quot;</span>, <span class=\"string\">&quot;è§¦å‘å™¨:&quot;</span> + trigger.getKey());</span><br><span class=\"line\">                    Trigger.TriggerState triggerState = scheduler.getTriggerState(trigger.getKey());</span><br><span class=\"line\">                    map.put(<span class=\"string\">&quot;jobStatus&quot;</span>, triggerState.name());</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (trigger <span class=\"keyword\">instanceof</span> CronTrigger) &#123;</span><br><span class=\"line\">                        CronTrigger cronTrigger = (CronTrigger) trigger;</span><br><span class=\"line\">                        String cronExpression = cronTrigger.getCronExpression();</span><br><span class=\"line\">                        map.put(<span class=\"string\">&quot;jobTime&quot;</span>, cronExpression);</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    jobList.add(map);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (SchedulerException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> jobList;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * è·å–æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„job</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> List&lt;Map&lt;String, Object&gt;&gt; queryRunJob() &#123;</span><br><span class=\"line\">        List&lt;Map&lt;String, Object&gt;&gt; jobList = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            List&lt;JobExecutionContext&gt; executingJobs = scheduler.getCurrentlyExecutingJobs();</span><br><span class=\"line\">            jobList = <span class=\"keyword\">new</span> ArrayList&lt;Map&lt;String, Object&gt;&gt;(executingJobs.size());</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (JobExecutionContext executingJob : executingJobs) &#123;</span><br><span class=\"line\">                Map&lt;String, Object&gt; map = <span class=\"keyword\">new</span> HashMap&lt;String, Object&gt;();</span><br><span class=\"line\">                JobDetail jobDetail = executingJob.getJobDetail();</span><br><span class=\"line\">                JobKey jobKey = jobDetail.getKey();</span><br><span class=\"line\">                Trigger trigger = executingJob.getTrigger();</span><br><span class=\"line\">                map.put(<span class=\"string\">&quot;jobName&quot;</span>, jobKey.getName());</span><br><span class=\"line\">                map.put(<span class=\"string\">&quot;jobGroupName&quot;</span>, jobKey.getGroup());</span><br><span class=\"line\">                map.put(<span class=\"string\">&quot;description&quot;</span>, <span class=\"string\">&quot;è§¦å‘å™¨:&quot;</span> + trigger.getKey());</span><br><span class=\"line\">                Trigger.TriggerState triggerState = scheduler.getTriggerState(trigger.getKey());</span><br><span class=\"line\">                map.put(<span class=\"string\">&quot;jobStatus&quot;</span>, triggerState.name());</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (trigger <span class=\"keyword\">instanceof</span> CronTrigger) &#123;</span><br><span class=\"line\">                    CronTrigger cronTrigger = (CronTrigger) trigger;</span><br><span class=\"line\">                    String cronExpression = cronTrigger.getCronExpression();</span><br><span class=\"line\">                    map.put(<span class=\"string\">&quot;jobTime&quot;</span>, cronExpression);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                jobList.add(map);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (SchedulerException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> jobList;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h1 id=\"é™†ã€åˆå§‹åŒ–ä»»åŠ¡\"><a href=\"#é™†ã€åˆå§‹åŒ–ä»»åŠ¡\" class=\"headerlink\" title=\"é™†ã€åˆå§‹åŒ–ä»»åŠ¡\"></a>é™†ã€åˆå§‹åŒ–ä»»åŠ¡</h1><p>è¿™é‡Œä¸å‡†å¤‡ç»™ç”¨æˆ·ç”¨webç•Œé¢æ¥é…ç½®å®šæ—¶ä»»åŠ¡ï¼Œæ•…æ­¤é‡‡ç”¨<strong>CommandLineRunner</strong>æ¥å­å•Šåº”ç”¨åˆå§‹åŒ–çš„æ—¶å€™æ¥åˆå§‹åŒ–ä»»åŠ¡ã€‚åªéœ€è¦å®ç°CommandLineRunnerçš„run()æ–¹æ³•å³å¯ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">(String... args)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">        HashMap&lt;String,Object&gt; map = <span class=\"keyword\">new</span> HashMap&lt;&gt;();</span><br><span class=\"line\">        map.put(<span class=\"string\">&quot;name&quot;</span>,<span class=\"number\">1</span>);</span><br><span class=\"line\">        quartzService.deleteJob(<span class=\"string\">&quot;job&quot;</span>, <span class=\"string\">&quot;test&quot;</span>);</span><br><span class=\"line\">        quartzService.addJob(Job.class, <span class=\"string\">&quot;job&quot;</span>, <span class=\"string\">&quot;test&quot;</span>, <span class=\"string\">&quot;0 * * * * ?&quot;</span>, map);</span><br><span class=\"line\"></span><br><span class=\"line\">        map.put(<span class=\"string\">&quot;name&quot;</span>,<span class=\"number\">2</span>);</span><br><span class=\"line\">        quartzService.deleteJob(<span class=\"string\">&quot;job2&quot;</span>, <span class=\"string\">&quot;test&quot;</span>);</span><br><span class=\"line\">        quartzService.addJob(Job.class, <span class=\"string\">&quot;job2&quot;</span>, <span class=\"string\">&quot;test&quot;</span>, <span class=\"string\">&quot;10 * * * * ?&quot;</span>, map);</span><br><span class=\"line\"></span><br><span class=\"line\">        map.put(<span class=\"string\">&quot;name&quot;</span>,<span class=\"number\">3</span>);</span><br><span class=\"line\">        quartzService.deleteJob(<span class=\"string\">&quot;job3&quot;</span>, <span class=\"string\">&quot;test2&quot;</span>);</span><br><span class=\"line\">        quartzService.addJob(Job.class, <span class=\"string\">&quot;job3&quot;</span>, <span class=\"string\">&quot;test2&quot;</span>, <span class=\"string\">&quot;15 * * * * ?&quot;</span>, map);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h1 id=\"æŸ’ã€æµ‹è¯•éªŒè¯\"><a href=\"#æŸ’ã€æµ‹è¯•éªŒè¯\" class=\"headerlink\" title=\"æŸ’ã€æµ‹è¯•éªŒè¯\"></a>æŸ’ã€æµ‹è¯•éªŒè¯</h1><p>åˆ†åˆ«å¤ä¾¯å¯åŠ¨ä¸¤ä¸ªåº”ç”¨ï¼Œç„¶åè§‚å¯Ÿä»»åŠ¡æ‰§è¡Œï¼Œä»¥åŠåœ¨è¿è¡Œè¿‡ç¨‹ä¸­æ€æ­»æŸä¸ªæœåŠ¡ï¼Œæ¥è§‚å¯Ÿå®šæ—¶ä»»åŠ¡çš„æ‰§è¡Œã€‚<br><img src=\"https://image.eelve.com/eblog/1-a8a710a578ad47a8afc8ace72f3cbd7c.png\" alt=\"SpringbootquartzoneApplication\"><br><img src=\"https://image.eelve.com/eblog/2-db731d38c3ed4b4b8123482c9b3ef28d.png\" alt=\"SpringbootquartztwoApplication\"></p>\n<p>ã€<strong>å†™åœ¨åé¢çš„è¯</strong>ã€‘ä¸‹é¢ç»™å‡ºçš„æ˜¯æ‰€éœ€è¦è„šæœ¬çš„è¿æ¥åœ°å€ï¼š<a href=\"http://www.quartz-scheduler.org/downloads/\">è„šæœ¬ä¸‹è½½åœ°å€</a>ï¼Œå¦å¤–è¿™è¾¹åˆä¸€ä¸ªè‡ªå·±å®ç°çš„<a href=\"https://github.com/eelve/springbootquartzs.git\">demo</a></p>\n<hr>\n<p><img src=\"https://image.eelve.com/eblog/eblog-b269767ff45b4e01a1c380e38898c1c0.png\" alt=\"è–ç±³ç¬”è®°\"></p>\n","raw":null,"categories":[{"name":"springboot","path":"api/categories/springboot.json"}],"tags":[{"name":"java","path":"api/tags/java.json"},{"name":"springboot","path":"api/tags/springboot.json"},{"name":"quartz","path":"api/tags/quartz.json"}]},{"title":"SpringBootæ‰“å¯æ‰§è¡ŒwaråŒ…","slug":"springboot-war","date":"2020-04-29T06:23:21.000Z","updated":"2021-04-19T06:44:39.199Z","comments":true,"path":"api/articles/springboot-war.json","excerpt":null,"keywords":"å—å›½è–ç±³","cover":"https://image.eelve.com/eblog/eblog-b269767ff45b4e01a1c380e38898c1c0.png","content":"<p>ã€<strong>å‰æƒ…æè¦</strong>ã€‘æœ€è¿‘åšäº†ä¸€ä¸ªSpringbooté¡¹ç›®ï¼Œä½†æ˜¯æœ€åéœ€è¦æ‰“æˆWARåŒ…åœ¨å®¹å™¨ä¸­éƒ¨ç½²ï¼Œä¸‹é¢å°±ç®€å•è®°å½•ä¸€ä¸‹ã€‚</p>\n<hr>\n<h1 id=\"å£¹ã€ä¿®æ”¹pomæ–‡ä»¶\"><a href=\"#å£¹ã€ä¿®æ”¹pomæ–‡ä»¶\" class=\"headerlink\" title=\"å£¹ã€ä¿®æ”¹pomæ–‡ä»¶\"></a>å£¹ã€ä¿®æ”¹pomæ–‡ä»¶</h1><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">project</span> <span class=\"attr\">xmlns</span>=<span class=\"string\">&quot;http://maven.apache.org/POM/4.0.0&quot;</span> <span class=\"attr\">xmlns:xsi</span>=<span class=\"string\">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span> <span class=\"attr\">xsi:schemaLocation</span>=<span class=\"string\">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">modelVersion</span>&gt;</span>4.0.0<span class=\"tag\">&lt;/<span class=\"name\">modelVersion</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.eelve<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>springboot-war<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>0.0.1-SNAPSHOT<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"comment\">&lt;!-- æ‰“åŒ…æ–¹å¼ --&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">packaging</span>&gt;</span>war<span class=\"tag\">&lt;/<span class=\"name\">packaging</span>&gt;</span></span><br><span class=\"line\">  </span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">parent</span>&gt;</span></span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-parent<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.2.6.RELEASE<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">relativePath</span>/&gt;</span> <span class=\"comment\">&lt;!-- lookup parent from repository --&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">parent</span>&gt;</span></span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">\t\t\t<span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">\t\t\t<span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-web<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\t<span class=\"comment\">&lt;!-- åµŒå…¥å¼tomcatç›¸å…³jarå°†è¢«æ”¾å…¥åˆ°WEB-INF\\lib-providedä¸‹ --&gt;</span></span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-tomcat<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">scope</span>&gt;</span>provided<span class=\"tag\">&lt;/<span class=\"name\">scope</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">build</span>&gt;</span></span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">plugins</span>&gt;</span></span><br><span class=\"line\">            <span class=\"comment\">&lt;!-- æ‰“åŒ…æ’ä»¶ --&gt;</span></span><br><span class=\"line\">\t\t\t<span class=\"tag\">&lt;<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">\t\t\t\t<span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">\t\t\t\t<span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">\t\t\t<span class=\"tag\">&lt;/<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;/<span class=\"name\">plugins</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">build</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">project</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h1 id=\"è´°ã€ä¿®æ”¹å¯åŠ¨ç±»\"><a href=\"#è´°ã€ä¿®æ”¹å¯åŠ¨ç±»\" class=\"headerlink\" title=\"è´°ã€ä¿®æ”¹å¯åŠ¨ç±»\"></a>è´°ã€ä¿®æ”¹å¯åŠ¨ç±»</h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.eelve.springboot.war;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.boot.SpringApplication;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.boot.builder.SpringApplicationBuilder;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.boot.web.support.SpringBootServletInitializer;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@SpringBootApplication</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">SpringbootWarApplication</span> <span class=\"keyword\">extends</span> <span class=\"title\">SpringBootServletInitializer</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"meta\">@Override</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">protected</span> SpringApplicationBuilder <span class=\"title\">configure</span><span class=\"params\">(SpringApplicationBuilder application)</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> application.sources(SpringbootWarApplication.class);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">\t\tSpringApplication.run(SpringbootWarApplication.class, args);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<hr>\n<p>ã€<strong>åé¢çš„è¯</strong>ã€‘ä½¿ç”¨mavenæ‰“åŒ…(clean package)ï¼Œç”Ÿæˆçš„waråŒ…å¯ä»¥ç”¨äºä¼ ç»Ÿçš„éƒ¨ç½²æ–¹å¼ï¼ˆå¤–éƒ¨tomcatï¼‰ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨java -jar çš„æ–¹å¼è¿è¡Œã€‚</p>\n<hr>\n<p><img src=\"https://image.eelve.com/eblog/eblog-b269767ff45b4e01a1c380e38898c1c0.png\" alt=\"è–ç±³ç¬”è®°\"></p>\n","raw":null,"categories":[{"name":"springboot","path":"api/categories/springboot.json"}],"tags":[{"name":"java","path":"api/tags/java.json"},{"name":"springboot","path":"api/tags/springboot.json"},{"name":"jar","path":"api/tags/jar.json"}]},{"title":"springboot+jspæ‰“jaré—®é¢˜","slug":"springboot-jspæ‰“jaré—®é¢˜","date":"2019-08-09T09:11:29.000Z","updated":"2021-04-19T06:44:39.192Z","comments":true,"path":"api/articles/springboot-jspæ‰“jaré—®é¢˜.json","excerpt":null,"keywords":"å—å›½è–ç±³","cover":"https://image.eelve.com/eblog/O$VVNDUD1GCU8FT%5DQH5Z@TM-23f04197a92d4a5db24b6e3fb656b7c1.png","content":"<p>ã€<strong>å‰æƒ…æè¦</strong>ã€‘æœ€è¿‘åšäº†ä¸€ä¸ªé¡¹ç›®ï¼Œé¡¹ç›®æ˜¯springboot+jspç»“æ„çš„ï¼Œä½†æ˜¯åœ¨å‘å¸ƒç”Ÿäº§ç¯å¢ƒçš„æ—¶å€™åˆéœ€è¦ç”¨mavenæ‰“æˆjaråŒ…ï¼Œä½†æ˜¯ä¸€å¼€å§‹çš„é»˜è®¤é…ç½®éƒ½ä¸æˆåŠŸã€‚ä¸‹é¢çš„æ–‡ç« å°±æ˜¯å…·ä½“çš„è§£å†³è¿‡ç¨‹ã€‚</p>\n<hr>\n<h1 id=\"å£¹ã€é¡¹ç›®ç»“æ„\"><a href=\"#å£¹ã€é¡¹ç›®ç»“æ„\" class=\"headerlink\" title=\"å£¹ã€é¡¹ç›®ç»“æ„\"></a>å£¹ã€é¡¹ç›®ç»“æ„</h1><p><img src=\"https://image.eelve.com/eblog/O$VVNDUD1GCU8FT%5DQH5Z@TM-23f04197a92d4a5db24b6e3fb656b7c1.png\" alt=\"é¡¹ç›®ç»“æ„\"></p>\n<h1 id=\"è´°ã€å¼‚å¸¸ç°è±¡\"><a href=\"#è´°ã€å¼‚å¸¸ç°è±¡\" class=\"headerlink\" title=\"è´°ã€å¼‚å¸¸ç°è±¡\"></a>è´°ã€å¼‚å¸¸ç°è±¡</h1><p>ä½¿ç”¨çš„JDKä¸º1.8ï¼Œspringbootç‰ˆæœ¬ä¸ºï¼š</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">parent</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-parent<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>1.5.6.RELEASE<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">relativePath</span>/&gt;</span> </span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">parent</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">properties</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class=\"tag\">&lt;/<span class=\"name\">project.build.sourceEncoding</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">project.reporting.outputEncoding</span>&gt;</span>UTF-8<span class=\"tag\">&lt;/<span class=\"name\">project.reporting.outputEncoding</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">java.version</span>&gt;</span>1.8<span class=\"tag\">&lt;/<span class=\"name\">java.version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">properties</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>æ‰“æˆçš„jaråªåŒ…å«classæ–‡ä»¶ï¼Œæ²¡æœ‰è§èµ„æºæ–‡ä»¶å¼•å…¥ã€‚<br><img src=\"https://image.eelve.com/eblog/20190713-90f9d3c88e4940de8c8faaa0b2d4ec7c.png\" alt=\"æ²¡æœ‰åŒ…å«resourseçš„ç¼–è¯‘ç»“æœ\"></p>\n<h1 id=\"åã€è§£å†³åŠæ³•\"><a href=\"#åã€è§£å†³åŠæ³•\" class=\"headerlink\" title=\"åã€è§£å†³åŠæ³•\"></a>åã€è§£å†³åŠæ³•</h1><h2 id=\"1-æ·»åŠ èµ„æºè·¯å¾„çš„æ˜ å°„\"><a href=\"#1-æ·»åŠ èµ„æºè·¯å¾„çš„æ˜ å°„\" class=\"headerlink\" title=\"1. æ·»åŠ èµ„æºè·¯å¾„çš„æ˜ å°„\"></a>1. æ·»åŠ èµ„æºè·¯å¾„çš„æ˜ å°„</h2><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">resources</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">resource</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">directory</span>&gt;</span>src/main/resources<span class=\"tag\">&lt;/<span class=\"name\">directory</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">includes</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">include</span>&gt;</span>**/**<span class=\"tag\">&lt;/<span class=\"name\">include</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;/<span class=\"name\">includes</span>&gt;</span></span><br><span class=\"line\">                <span class=\"comment\">&lt;!-- å¼€å¯è¿‡æ»¤ï¼Œç”¨æŒ‡å®šçš„å‚æ•°æ›¿æ¢directoryä¸‹çš„æ–‡ä»¶ä¸­çš„å‚æ•° --&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">filtering</span>&gt;</span>false<span class=\"tag\">&lt;/<span class=\"name\">filtering</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">resource</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">resource</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">directory</span>&gt;</span>src/main/webapp<span class=\"tag\">&lt;/<span class=\"name\">directory</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">targetPath</span>&gt;</span>META-INF/resources<span class=\"tag\">&lt;/<span class=\"name\">targetPath</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">includes</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">include</span>&gt;</span>**/**<span class=\"tag\">&lt;/<span class=\"name\">include</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;/<span class=\"name\">includes</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">resource</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">resource</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">directory</span>&gt;</span>src/main/java<span class=\"tag\">&lt;/<span class=\"name\">directory</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">excludes</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">exclude</span>&gt;</span></span><br><span class=\"line\">                        **/*.java</span><br><span class=\"line\">                    <span class=\"tag\">&lt;/<span class=\"name\">exclude</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;/<span class=\"name\">excludes</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">resource</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">resources</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"2-ä¿®æ”¹mavenç¼–è¯‘ç‰ˆæœ¬ä¸º1-4-2\"><a href=\"#2-ä¿®æ”¹mavenç¼–è¯‘ç‰ˆæœ¬ä¸º1-4-2\" class=\"headerlink\" title=\"2. ä¿®æ”¹mavenç¼–è¯‘ç‰ˆæœ¬ä¸º1.4.2\"></a>2. ä¿®æ”¹mavenç¼–è¯‘ç‰ˆæœ¬ä¸º1.4.2</h2><p>åªæœ‰ä½¿ç”¨è¿™ä¸ªç‰ˆæœ¬æ‰“jaråŒ…æ‰èƒ½è§£æjsp</p>\n<h2 id=\"3-è®¾ç½®mainClass\"><a href=\"#3-è®¾ç½®mainClass\" class=\"headerlink\" title=\"3. è®¾ç½®mainClass\"></a>3. è®¾ç½®mainClass</h2><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">plugins</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">                <span class=\"comment\">&lt;!-- mavenæ’ä»¶ --&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>1.4.2.RELEASE<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">mainClass</span>&gt;</span>com.gt.LaysshApplication<span class=\"tag\">&lt;/<span class=\"name\">mainClass</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">plugins</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"4-æ·»åŠ è§†å›¾é…ç½®ï¼ˆå¯é€‰ï¼‰\"><a href=\"#4-æ·»åŠ è§†å›¾é…ç½®ï¼ˆå¯é€‰ï¼‰\" class=\"headerlink\" title=\"4. æ·»åŠ è§†å›¾é…ç½®ï¼ˆå¯é€‰ï¼‰\"></a>4. æ·»åŠ è§†å›¾é…ç½®ï¼ˆå¯é€‰ï¼‰</h2><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">spring.mvc.view.prefix=/WEB-INF/jsp/</span><br><span class=\"line\"></span><br><span class=\"line\">spring.mvc.view.suffix=.jsp</span><br></pre></td></tr></table></figure>\n<p>ä¸‹é¢ç»™å‡ºä¸€ä¸ªæ¯”è¾ƒå®Œæ•´çš„mavenç¼–è¯‘é…ç½®</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">build</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">resources</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">resource</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">directory</span>&gt;</span>src/main/resources<span class=\"tag\">&lt;/<span class=\"name\">directory</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">includes</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">include</span>&gt;</span>**/**<span class=\"tag\">&lt;/<span class=\"name\">include</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;/<span class=\"name\">includes</span>&gt;</span></span><br><span class=\"line\">                <span class=\"comment\">&lt;!-- å¼€å¯è¿‡æ»¤ï¼Œç”¨æŒ‡å®šçš„å‚æ•°æ›¿æ¢directoryä¸‹çš„æ–‡ä»¶ä¸­çš„å‚æ•° --&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">filtering</span>&gt;</span>false<span class=\"tag\">&lt;/<span class=\"name\">filtering</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">resource</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">resource</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">directory</span>&gt;</span>src/main/webapp<span class=\"tag\">&lt;/<span class=\"name\">directory</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">targetPath</span>&gt;</span>META-INF/resources<span class=\"tag\">&lt;/<span class=\"name\">targetPath</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">includes</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">include</span>&gt;</span>**/**<span class=\"tag\">&lt;/<span class=\"name\">include</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;/<span class=\"name\">includes</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">resource</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">resource</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">directory</span>&gt;</span>src/main/java<span class=\"tag\">&lt;/<span class=\"name\">directory</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">excludes</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">exclude</span>&gt;</span></span><br><span class=\"line\">                        **/*.java</span><br><span class=\"line\">                    <span class=\"tag\">&lt;/<span class=\"name\">exclude</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;/<span class=\"name\">excludes</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">resource</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">resources</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">plugins</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">                <span class=\"comment\">&lt;!-- mavenæ’ä»¶ --&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>1.4.2.RELEASE<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">mainClass</span>&gt;</span>com.gt.MyApplication<span class=\"tag\">&lt;/<span class=\"name\">mainClass</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">plugins</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">build</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>ä¸‹é¢å°±æ˜¯ä¿®æ”¹ç¼–è¯‘é…ç½®ä¹‹åçš„ç»“æœ</p>\n<p><img src=\"https://image.eelve.com/eblog/201907192-13a348f78e4c4d1cb0b6485cf535dfbe.png\" alt=\"æ­£ç¡®çš„ç»“æœ\"></p>\n<hr>\n<p>ã€å†™åœ¨åé¢çš„è¯ã€‘ç°ä»£çš„æ¨¡æ¿è§£æå¼•æ“å·²ç»æœ‰äº†è¿™ä¹ˆå¤šäº†ï¼Œä¸ºä»€ä¹ˆä¸è¯•ä¸€ä¸‹<strong>thymeleaf</strong>ï¼Œä½†æ˜¯åœ¨æœ€è¿‘çš„é¡¹ç›®ä¸­ç¢°åˆ°äº†th:srcæ ‡ç­¾ä¸è§£æçš„é—®é¢˜ï¼Œç›®å‰è¿˜ä¸æ¸…æ¥šå…·ä½“åŸå› ï¼Œè€Œä¸”ç›¸åŒçš„å†™æ³•åœ¨å…¶ä»–é¡µé¢éƒ½ç”Ÿæ•ˆï¼ŒçœŸæ˜¯æ€ªå¼‚å•Šã€‚é‰´äºç›®å‰è¿˜æ˜¯åˆå¾ˆå¤šäººä½¿ç”¨springboot+jspæ¥è¿›è¡Œå¼€å‘ï¼Œä½†æ˜¯å› ä¸ºä½¿ç”¨IDEAå·¥å…·åˆ›å»ºçš„SpringBooté¡¹ç›®æœ¬èº«æ˜¯æ²¡æœ‰webappç›®å½•çš„ã€‚å¦‚æœæˆ‘ä»¬æƒ³è¦æ·»åŠ webappç›®å½•çš„è¯ï¼Œå¯ä»¥æ‰‹åŠ¨æ·»åŠ ã€‚ä¸‹é¢å°±ç®€å•çš„æ¥è¯´ä¸€ä¸‹é…ç½®è¿‡ç¨‹ã€‚</p>\n<hr>\n<h2 id=\"1-ç‚¹å¼€é¡¹ç›®ç»“æ„ç®¡ç†ï¼Œç‚¹å‡»IDEAå³ä¸Šè§’çš„Project-Structure\"><a href=\"#1-ç‚¹å¼€é¡¹ç›®ç»“æ„ç®¡ç†ï¼Œç‚¹å‡»IDEAå³ä¸Šè§’çš„Project-Structure\" class=\"headerlink\" title=\"1.ç‚¹å¼€é¡¹ç›®ç»“æ„ç®¡ç†ï¼Œç‚¹å‡»IDEAå³ä¸Šè§’çš„Project Structure\"></a>1.ç‚¹å¼€é¡¹ç›®ç»“æ„ç®¡ç†ï¼Œç‚¹å‡»IDEAå³ä¸Šè§’çš„Project Structure</h2><p><img src=\"https://image.eelve.com/eblog/201907193-7d050c6d01c1449f999bb49a5c11fda8.png\" alt=\"Project Structure\"></p>\n<h2 id=\"2-å…ˆç‚¹å‡»ä¸‹å›¾ä¸­çš„-å·ï¼Œå†ç‚¹å‡»Web\"><a href=\"#2-å…ˆç‚¹å‡»ä¸‹å›¾ä¸­çš„-å·ï¼Œå†ç‚¹å‡»Web\" class=\"headerlink\" title=\"2.å…ˆç‚¹å‡»ä¸‹å›¾ä¸­çš„+å·ï¼Œå†ç‚¹å‡»Web\"></a>2.å…ˆç‚¹å‡»ä¸‹å›¾ä¸­çš„+å·ï¼Œå†ç‚¹å‡»Web</h2><p><img src=\"https://image.eelve.com/eblog/2019071904-f795ae6044024bafbd02136c86fbfbda.png\" alt=\"2019071904\"></p>\n<h2 id=\"3-ä¿®æ”¹é…ç½®\"><a href=\"#3-ä¿®æ”¹é…ç½®\" class=\"headerlink\" title=\"3.ä¿®æ”¹é…ç½®\"></a>3.ä¿®æ”¹é…ç½®</h2><p>ä¸‹å›¾æ˜¯ä¿®æ”¹é…ç½®å‰çš„é»˜è®¤é…ç½®<br><img src=\"https://image.eelve.com/eblog/20190705-bb62a58b15d24b098aa2db949d18de32.png\" alt=\"ä¿®æ”¹å‰çš„é…ç½®\"><br>ä¸‹é¢å°†webappé…ç½®åˆ°ä¼ ç»Ÿçš„mainç›®å½•ä¸‹<br><img src=\"https://image.eelve.com/eblog/2019071906-d580c788cbd94ff7ba7cb43d70fb5ebb.png\" alt=\"ä¿®æ”¹åçš„é…ç½®\"><br><img src=\"https://image.eelve.com/eblog/2019071906-4c565cc7039a4ed7b0dff2044d3e1bae.png\" alt=\"é…ç½®Artifacts\"><br><img src=\"https://image.eelve.com/eblog/2019071907-1a3c18ec66514327b6f5b635dfde0f67.png\" alt=\"æœ€åçš„é…ç½®æˆåŠŸçš„ç»“æœ\"></p>\n<hr>\n<p><img src=\"https://image.eelve.com/eblog/eblog-b269767ff45b4e01a1c380e38898c1c0.png\" alt=\"è–ç±³ç¬”è®°\"></p>\n","raw":null,"categories":[{"name":"springboot","path":"api/categories/springboot.json"}],"tags":[{"name":"java","path":"api/tags/java.json"},{"name":"springboot","path":"api/tags/springboot.json"},{"name":"jar","path":"api/tags/jar.json"},{"name":"jsp","path":"api/tags/jsp.json"}]},{"title":"ä½¿ç”¨Jasyptå¯¹SpringBooté…ç½®æ–‡ä»¶åŠ å¯†","slug":"ä½¿ç”¨Jasyptå¯¹SpringBooté…ç½®æ–‡ä»¶åŠ å¯†","date":"2019-08-09T09:14:23.000Z","updated":"2021-04-19T06:44:39.204Z","comments":true,"path":"api/articles/ä½¿ç”¨Jasyptå¯¹SpringBooté…ç½®æ–‡ä»¶åŠ å¯†.json","excerpt":null,"keywords":"å—å›½è–ç±³","cover":"https://image.eelve.com/eblog/springbootjasypydiagrams-3a7616cc841c4f7583fc7173e32aaab4.png","content":"<h1 id=\"å‰è¨€\"><a href=\"#å‰è¨€\" class=\"headerlink\" title=\"å‰è¨€\"></a><strong>å‰è¨€</strong></h1><p>åœ¨æ—¥å‰å®‰å…¨å½¢åŠ¿è¶Šæ¥è¶Šä¸¥é‡çš„æƒ…å†µä¸‹ï¼Œè®©æˆ‘æ„è¯†åˆ°åœ¨é¡¹ç›®ä¸­å­˜åœ¨ä¸€ä¸ªæˆ‘ä»¬ç»å¸¸å¿½ç•¥çš„æ¼æ´ï¼Œé‚£å°±æ˜¯æˆ‘ä»¬çš„é¡¹ç›®çš„é…ç½®æ–‡ä»¶ä¸­é…ç½®ä¿¡æ¯çš„å®‰å…¨ï¼Œå°¤å…¶æ˜¯æ•°æ®åº“è¿æ¥çš„ç”¨æˆ·åå’Œå¯†ç çš„å®‰å…¨ã€‚æ‰€ä»¥è¿™é‡Œæˆ‘ä»¬å°±éœ€è¦å¯¹æ•°æ®åº“çš„ç”¨æˆ·åå’Œå¯†ç è¿›è¡ŒåŠ å¯†ï¼Œè¿™ä¹Ÿæ˜¯æœ¬æ–‡çš„ç”±æ¥ã€‚æœ¬æ–‡é‡‡ç”¨Jasyptå¯¹Spring Booté…ç½®æ–‡ä»¶åŠ å¯†çš„ç›¸å…³æ–¹æ³•ï¼Œå…¶å®å‘¢ï¼Œä¹Ÿè¿˜æœ‰å…¶ä»–æ–¹æ¡ˆï¼Œå…·ä½“çš„ä¼šåœ¨åé¢çš„ç›¸å…³æ–‡ç« ä¸­è¯´æ˜ã€‚</p>\n<h1 id=\"å¼•å…¥jasypt\"><a href=\"#å¼•å…¥jasypt\" class=\"headerlink\" title=\"å¼•å…¥jasypt\"></a><strong>å¼•å…¥jasypt</strong></h1><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.github.ulisesbocchio<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>jasypt-spring-boot-starter<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.0.0<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h1 id=\"1-ç”Ÿæˆè¦åŠ å¯†çš„å­—ç¬¦ä¸²\"><a href=\"#1-ç”Ÿæˆè¦åŠ å¯†çš„å­—ç¬¦ä¸²\" class=\"headerlink\" title=\"1.ç”Ÿæˆè¦åŠ å¯†çš„å­—ç¬¦ä¸²\"></a><strong>1.ç”Ÿæˆè¦åŠ å¯†çš„å­—ç¬¦ä¸²</strong></h1><h2 id=\"1-1-å°†æ•°æ®åº“çš„ç”¨æˆ·åå’Œå¯†ç è¿›è¡ŒåŠ å¯†\"><a href=\"#1-1-å°†æ•°æ®åº“çš„ç”¨æˆ·åå’Œå¯†ç è¿›è¡ŒåŠ å¯†\" class=\"headerlink\" title=\"1.1 å°†æ•°æ®åº“çš„ç”¨æˆ·åå’Œå¯†ç è¿›è¡ŒåŠ å¯†\"></a>1.1 å°†æ•°æ®åº“çš„ç”¨æˆ·åå’Œå¯†ç è¿›è¡ŒåŠ å¯†</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Test</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">contextLoads</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        BasicTextEncryptor textEncryptor = <span class=\"keyword\">new</span> BasicTextEncryptor();</span><br><span class=\"line\">        <span class=\"comment\">//åŠ å¯†æ‰€éœ€çš„salt(ç›)</span></span><br><span class=\"line\">        textEncryptor.setPassword(<span class=\"string\">&quot;1Qaz0oKm&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">//è¦åŠ å¯†çš„æ•°æ®ï¼ˆæ•°æ®åº“çš„ç”¨æˆ·åæˆ–å¯†ç ï¼‰</span></span><br><span class=\"line\">        String username = textEncryptor.encrypt(<span class=\"string\">&quot;root&quot;</span>);</span><br><span class=\"line\">        String password = textEncryptor.encrypt(<span class=\"string\">&quot;root&quot;</span>);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;username:&quot;</span>+username);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;password:&quot;</span>+password);</span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n<p><strong>è¾“å‡ºä¿¡æ¯</strong></p>\n<figure class=\"highlight shell\"><figcaption><span>script</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">username:NZmLHOOHX0SEjc285iG9YQ==</span><br><span class=\"line\">password:1JByM5wu5o+9H1Ba2o++Pg==</span><br><span class=\"line\">2019-06-14 14:55:49.863  INFO 8904 --- [       Thread-3] o.s.s.concurrent.ThreadPoolTaskExecutor  : Shutting down ExecutorService &#x27;applicationTaskExecutor&#x27;</span><br><span class=\"line\">2019-06-14 14:55:49.863  INFO 8904 --- [       Thread-3] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit &#x27;default&#x27;</span><br><span class=\"line\">2019-06-14 14:55:49.863  INFO 8904 --- [       Thread-3] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...</span><br><span class=\"line\">2019-06-14 14:55:49.878  INFO 8904 --- [       Thread-3] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.</span><br></pre></td></tr></table></figure>\n<h2 id=\"1-2-æˆ–è€…ä½¿ç”¨Mavenä¸‹è½½å¥½çš„jaråŒ…åŠ å¯†-Maven-org-jasypt-jasypt-2-0-0-jasypt-2-0-0-jar\"><a href=\"#1-2-æˆ–è€…ä½¿ç”¨Mavenä¸‹è½½å¥½çš„jaråŒ…åŠ å¯†-Maven-org-jasypt-jasypt-2-0-0-jasypt-2-0-0-jar\" class=\"headerlink\" title=\"1.2. æˆ–è€…ä½¿ç”¨Mavenä¸‹è½½å¥½çš„jaråŒ…åŠ å¯†\\Maven\\org\\jasypt\\jasypt\\2.0.0\\jasypt-2.0.0.jar\"></a>1.2. æˆ–è€…ä½¿ç”¨Mavenä¸‹è½½å¥½çš„jaråŒ…åŠ å¯†\\Maven\\org\\jasypt\\jasypt\\2.0.0\\jasypt-2.0.0.jar</h2><figure class=\"highlight shell\"><figcaption><span>script</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">java -cp jasypt-1.9.2.jar org.jasypt.intf.cli.JasyptPBEStringEncryptionCLI password=1Qaz0oKm algorithm=PBEWithMD5AndDES input=root</span><br></pre></td></tr></table></figure>\n<p><strong>è¾“å‡ºä¿¡æ¯</strong></p>\n<figure class=\"highlight shell\"><figcaption><span>script</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">----ENVIRONMENT-----------------</span><br><span class=\"line\">Runtime: Oracle Corporation Java HotSpot(TM) 64-Bit Server VM 25.171-b11</span><br><span class=\"line\"></span><br><span class=\"line\">----ARGUMENTS-------------------</span><br><span class=\"line\">input: root</span><br><span class=\"line\">algorithm: PBEWithMD5AndDES</span><br><span class=\"line\">password: 1Qaz0oKm </span><br><span class=\"line\"></span><br><span class=\"line\">----OUTPUT----------------------</span><br><span class=\"line\">NZmLHOOHX0SEjc285iG9YQ==</span><br></pre></td></tr></table></figure>\n<p>æ‹·è´-OUTPUT-ä¸‹çš„ç»“æœå³å¯</p>\n<h1 id=\"2-é…ç½®propertiesæ–‡ä»¶\"><a href=\"#2-é…ç½®propertiesæ–‡ä»¶\" class=\"headerlink\" title=\"2.é…ç½®propertiesæ–‡ä»¶\"></a><strong>2.é…ç½®propertiesæ–‡ä»¶</strong></h1><p>å°†ç”Ÿæˆçš„åŠ å¯†ä¸²é…ç½®ENC(åŠ å¯†ä¸²)åˆ°application.propertiesä¸­</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">server:</span></span><br><span class=\"line\">  <span class=\"attr\">port:</span> <span class=\"number\">8080</span></span><br><span class=\"line\"><span class=\"attr\">spring:</span></span><br><span class=\"line\">  <span class=\"attr\">datasource:</span></span><br><span class=\"line\">    <span class=\"attr\">url:</span> <span class=\"string\">jdbc:mysql://localhost:3306/test?serverTimezone=UTC&amp;useUnicode=true&amp;characterEncoding=utf-8&amp;useSSL=true</span></span><br><span class=\"line\">    <span class=\"attr\">username:</span> <span class=\"string\">ENC(GHK23XVFNHoQQ97vIW523Q==)</span></span><br><span class=\"line\">    <span class=\"attr\">password:</span> <span class=\"string\">ENC(aTKef0XcG05Cfzao92EqqQ==)</span></span><br><span class=\"line\">    <span class=\"attr\">data-username:</span> <span class=\"string\">com.mysql.cj.jdbc.Driver</span></span><br><span class=\"line\">  <span class=\"attr\">jpa:</span></span><br><span class=\"line\">    <span class=\"attr\">show-sql:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">    <span class=\"attr\">database-platform:</span> <span class=\"string\">org.hibernate.dialect.MySQL5InnoDBDialect</span></span><br><span class=\"line\">    <span class=\"attr\">database:</span> <span class=\"string\">MYSQL</span></span><br><span class=\"line\">    <span class=\"attr\">hibernate:</span></span><br><span class=\"line\">      <span class=\"attr\">ddl-auto:</span> <span class=\"string\">update</span></span><br><span class=\"line\"><span class=\"attr\">jasypt:</span></span><br><span class=\"line\">  <span class=\"attr\">encryptor:</span></span><br><span class=\"line\">    <span class=\"attr\">password:</span> <span class=\"string\">1Qaz0oKm</span> <span class=\"comment\">#åŠ å¯†æ‰€éœ€çš„salt(ç›)</span></span><br><span class=\"line\">    <span class=\"comment\">#algorithm: PBEWithMD5AndDES   # é»˜è®¤åŠ å¯†æ–¹å¼PBEWithMD5AndDES,å¯ä»¥æ›´æ”¹ä¸ºPBEWithMD5AndTripleDES</span></span><br></pre></td></tr></table></figure>\n<p><strong>åŠ å¯†æ–¹å¼å¯¹åº”çš„ç±»ä¸ºBasicTextEncryptorå’ŒStrongTextEncryptor</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">final</span> StandardPBEStringEncryptor encryptor = <span class=\"keyword\">new</span> StandardPBEStringEncryptor();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">BasicTextEncryptor</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.encryptor.setAlgorithm(<span class=\"string\">&quot;PBEWithMD5AndDES&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">final</span> StandardPBEStringEncryptor encryptor = <span class=\"keyword\">new</span> StandardPBEStringEncryptor();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">StrongTextEncryptor</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.encryptor.setAlgorithm(<span class=\"string\">&quot;PBEWithMD5AndTripleDES&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://image.eelve.com/eblog/springbootjasypydiagrams-3a7616cc841c4f7583fc7173e32aaab4.png\" alt=\"å›¾ç‰‡.png\"></p>\n<h1 id=\"3-éƒ¨ç½²æ—¶é…ç½®salt-ç›-å€¼\"><a href=\"#3-éƒ¨ç½²æ—¶é…ç½®salt-ç›-å€¼\" class=\"headerlink\" title=\"3.éƒ¨ç½²æ—¶é…ç½®salt(ç›)å€¼\"></a><strong>3.éƒ¨ç½²æ—¶é…ç½®salt(ç›)å€¼</strong></h1><p><strong>1. ä¸ºäº†é˜²æ­¢salt(ç›)æ³„éœ²,åè§£å‡ºå¯†ç .å¯ä»¥åœ¨é¡¹ç›®éƒ¨ç½²çš„æ—¶å€™ä½¿ç”¨å‘½ä»¤ä¼ å…¥salt(ç›)å€¼</strong></p>\n<figure class=\"highlight shell\"><figcaption><span>script</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">java -jar -Djasypt.encryptor.password=1Qaz0oKm xxx.jar</span><br></pre></td></tr></table></figure>\n<p><strong>2. æˆ–è€…åœ¨æœåŠ¡å™¨çš„ç¯å¢ƒå˜é‡é‡Œé…ç½®,è¿›ä¸€æ­¥æé«˜å®‰å…¨æ€§</strong></p>\n<figure class=\"highlight shell\"><figcaption><span>script</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">æ‰“å¼€/etc/profileæ–‡ä»¶</span><br><span class=\"line\">vim /etc/profile</span><br><span class=\"line\"></span><br><span class=\"line\">æ–‡ä»¶æœ«å°¾æ’å…¥</span><br><span class=\"line\">export JASYPT_PASSWORD = G0CvDz7oJn6</span><br><span class=\"line\"></span><br><span class=\"line\">ç¼–è¯‘ </span><br><span class=\"line\">source /etc/profile</span><br><span class=\"line\"></span><br><span class=\"line\">è¿è¡Œ </span><br><span class=\"line\">java -jar -Djasypt.encryptor.password=$&#123;JASYPT_PASSWORD&#125; xxx.jar</span><br></pre></td></tr></table></figure>\n<p><a href=\"https://github.com/eelve/jasypt\">ä¸‹é¢æ˜¯ä¸€ä¸ªæˆ‘è‡ªå·±çš„å…·ä½“å®ç°ï¼šhttps://github.com/eelve/jasyptï¼Œä½¿ç”¨Jasyptå¯¹æ•°æ®åº“ç”¨ä¿¡æ¯åŠ å¯†åï¼Œå¯ä»¥æˆåŠŸè¿æ¥ä¸Šæ•°æ®åº“</a><br><img src=\"https://image.eelve.com/eblog/springbootjasypyresult-5f2ef70fe5124f5595a48b341807f2c3.png\" alt=\"å›¾ç‰‡.png\"></p>\n<p><a href=\"https://github.com/ulisesbocchio/jasypt-spring-boot\">å®˜æ–¹åœ°å€ï¼šhttps://github.com/ulisesbocchio/jasypt-spring-boot</a></p>\n<hr>\n<p><img src=\"https://image.eelve.com/eblog/eblog-b269767ff45b4e01a1c380e38898c1c0.png\" alt=\"è–ç±³ç¬”è®°\"></p>\n","raw":null,"categories":[{"name":"springboot","path":"api/categories/springboot.json"}],"tags":[{"name":"java","path":"api/tags/java.json"},{"name":"springboot","path":"api/tags/springboot.json"},{"name":"jasypt","path":"api/tags/jasypt.json"}]},{"title":"SpringBooté…ç½®webè®¿é—®H2","slug":"SpringBooté…ç½®webè®¿é—®H2","date":"2019-08-09T09:13:41.000Z","updated":"2021-04-19T06:44:39.290Z","comments":true,"path":"api/articles/SpringBooté…ç½®webè®¿é—®H2.json","excerpt":null,"keywords":"å—å›½è–ç±³","cover":"https://image.eelve.com/eblog/h2databasecollection-bffb24f29c9947b8871454427c88a9a3.png","content":"<p>ã€<strong>å‰æƒ…æè¦</strong>ã€‘æœ€è¿‘å¼€å§‹æ­å»ºåšå®¢ï¼Œåœ¨æœ¬åœ°è°ƒè¯•çš„æ—¶å€™ä½¿ç”¨çš„æ•°æ®åº“æ˜¯h2ï¼Œä½†æ˜¯è°ƒè¯•çš„æ—¶å€™éœ€è¦æŸ¥çœ‹æ•°æ®åº“ï¼Œæœ¬æ–‡ä¹Ÿç”±æ­¤è€Œæ¥ã€‚</p>\n<hr>\n<p>ä¸‹é¢æ˜¯æˆ‘ç”¨åˆ°çš„æ–¹æ³•ï¼š</p>\n<ol>\n<li>ä½¿ç”¨IDEAçš„Databaseè¿æ¥å·¥å…·ï¼Œå…·ä½“æ“ä½œæ–¹æ³•å°±æ˜¯æŒ‰ç…§è¦æ±‚é…ç½®è¿æ¥urlï¼Œç”¨æˆ·åå’Œå¯†ç å³å¯ã€‚å…·ä½“æ“ä½œè§ä¸‹å›¾ï¼š<br><img src=\"https://image.eelve.com/eblog/h2databasecollection-bffb24f29c9947b8871454427c88a9a3.png\" alt=\"h2ideadatabaseé…ç½®\"><br>æŸ¥è¯¢ç»“æœï¼š<br><img src=\"https://image.eelve.com/eblog/h2databaseselect-5f10495470e446f98af7b8aff0228ef2.png\" alt=\"h2ideadatabaseæŸ¥è¯¢ç»“æœ\"><br>ä½†æ˜¯ä½†æ˜¯è¿™ä¸ªæ—¶å€™å¯åŠ¨<strong>é¡¹ç›®ä¼šæŠ¥é”™</strong>ï¼š<figure class=\"highlight shell\"><figcaption><span>script</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">org.h2.jdbc.JdbcSQLException: Database may be already in use: null. Possible solutions: close all other connection(s); use the server mode [90020-197]</span><br><span class=\"line\">\tat org.h2.message.DbException.getJdbcSQLException(DbException.java:357) ~[h2-1.4.197.jar:1.4.197]</span><br><span class=\"line\">\tat org.h2.message.DbException.get(DbException.java:168) ~[h2-1.4.197.jar:1.4.197]</span><br><span class=\"line\">\tat org.h2.mvstore.db.MVTableEngine$Store.convertIllegalStateException(MVTableEngine.java:188) ~[h2-1.4.197.jar:1.4.197]</span><br><span class=\"line\">\tat org.h2.mvstore.db.MVTableEngine$Store.open(MVTableEngine.java:168) ~[h2-1.4.197.jar:1.4.197]</span><br><span class=\"line\">\tat org.h2.mvstore.db.MVTableEngine.init(MVTableEngine.java:100) ~[h2-1.4.197.jar:1.4.197]</span><br><span class=\"line\">\tat org.h2.engine.Database.getPageStore(Database.java:2538) ~[h2-1.4.197.jar:1.4.197]</span><br><span class=\"line\">\tat org.h2.engine.Database.open(Database.java:709) ~[h2-1.4.197.jar:1.4.197]</span><br><span class=\"line\">\tat org.h2.engine.Database.openDatabase(Database.java:286) ~[h2-1.4.197.jar:1.4.197]</span><br><span class=\"line\">\tat org.h2.engine.Database.&lt;init&gt;(Database.java:280) ~[h2-1.4.197.jar:1.4.197]</span><br><span class=\"line\">\tat org.h2.engine.Engine.openSession(Engine.java:66) ~[h2-1.4.197.jar:1.4.197]</span><br><span class=\"line\">\tat org.h2.engine.Engine.openSession(Engine.java:179) ~[h2-1.4.197.jar:1.4.197]</span><br><span class=\"line\">\tat org.h2.engine.Engine.createSessionAndValidate(Engine.java:157) ~[h2-1.4.197.jar:1.4.197]</span><br><span class=\"line\">\tat org.h2.engine.Engine.createSession(Engine.java:140) ~[h2-1.4.197.jar:1.4.197]</span><br><span class=\"line\">\tat org.h2.engine.Engine.createSession(Engine.java:28) ~[h2-1.4.197.jar:1.4.197]</span><br><span class=\"line\">\tat org.h2.engine.SessionRemote.connectEmbeddedOrServer(SessionRemote.java:351) ~[h2-1.4.197.jar:1.4.197]</span><br><span class=\"line\">\tat org.h2.jdbc.JdbcConnection.&lt;init&gt;(JdbcConnection.java:124) ~[h2-1.4.197.jar:1.4.197]</span><br><span class=\"line\">\tat org.h2.jdbc.JdbcConnection.&lt;init&gt;(JdbcConnection.java:103) ~[h2-1.4.197.jar:1.4.197]</span><br><span class=\"line\">\tat org.h2.Driver.connect(Driver.java:69) ~[h2-1.4.197.jar:1.4.197]</span><br><span class=\"line\">\tat com.zaxxer.hikari.util.DriverDataSource.getConnection(DriverDataSource.java:136) ~[HikariCP-3.2.0.jar:na]</span><br><span class=\"line\">\tat com.zaxxer.hikari.pool.PoolBase.newConnection(PoolBase.java:369) ~[HikariCP-3.2.0.jar:na]</span><br><span class=\"line\">\tat com.zaxxer.hikari.pool.PoolBase.newPoolEntry(PoolBase.java:198) ~[HikariCP-3.2.0.jar:na]</span><br><span class=\"line\">\tat com.zaxxer.hikari.pool.HikariPool.createPoolEntry(HikariPool.java:467) [HikariCP-3.2.0.jar:na]</span><br><span class=\"line\">\tat com.zaxxer.hikari.pool.HikariPool.checkFailFast(HikariPool.java:541) [HikariCP-3.2.0.jar:na]</span><br><span class=\"line\">\tat com.zaxxer.hikari.pool.HikariPool.&lt;init&gt;(HikariPool.java:115) [HikariCP-3.2.0.jar:na]</span><br><span class=\"line\">\tat com.zaxxer.hikari.HikariDataSource.getConnection(HikariDataSource.java:112) [HikariCP-3.2.0.jar:na]</span><br><span class=\"line\">\tat org.springframework.jdbc.datasource.DataSourceUtils.fetchConnection(DataSourceUtils.java:157) [spring-jdbc-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.jdbc.datasource.DataSourceUtils.doGetConnection(DataSourceUtils.java:115) [spring-jdbc-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.jdbc.datasource.DataSourceUtils.getConnection(DataSourceUtils.java:78) [spring-jdbc-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.jdbc.support.JdbcUtils.extractDatabaseMetaData(JdbcUtils.java:319) [spring-jdbc-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.jdbc.support.JdbcUtils.extractDatabaseMetaData(JdbcUtils.java:356) [spring-jdbc-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.boot.autoconfigure.orm.jpa.DatabaseLookup.getDatabase(DatabaseLookup.java:73) [spring-boot-autoconfigure-2.1.3.RELEASE.jar:2.1.3.RELEASE]</span><br><span class=\"line\">\tat org.springframework.boot.autoconfigure.orm.jpa.JpaProperties.determineDatabase(JpaProperties.java:142) [spring-boot-autoconfigure-2.1.3.RELEASE.jar:2.1.3.RELEASE]</span><br><span class=\"line\">\tat org.springframework.boot.autoconfigure.orm.jpa.JpaBaseConfiguration.jpaVendorAdapter(JpaBaseConfiguration.java:113) [spring-boot-autoconfigure-2.1.3.RELEASE.jar:2.1.3.RELEASE]</span><br><span class=\"line\">\tat org.springframework.boot.autoconfigure.orm.jpa.HibernateJpaConfiguration$$EnhancerBySpringCGLIB$$4bb137a5.CGLIB$jpaVendorAdapter$6(&lt;generated&gt;) [spring-boot-autoconfigure-2.1.3.RELEASE.jar:2.1.3.RELEASE]</span><br><span class=\"line\">\tat org.springframework.boot.autoconfigure.orm.jpa.HibernateJpaConfiguration$$EnhancerBySpringCGLIB$$4bb137a5$$FastClassBySpringCGLIB$$824457c4.invoke(&lt;generated&gt;) [spring-boot-autoconfigure-2.1.3.RELEASE.jar:2.1.3.RELEASE]</span><br><span class=\"line\">\tat org.springframework.cglib.proxy.MethodProxy.invokeSuper(MethodProxy.java:244) [spring-core-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.context.annotation.ConfigurationClassEnhancer$BeanMethodInterceptor.intercept(ConfigurationClassEnhancer.java:363) [spring-context-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.boot.autoconfigure.orm.jpa.HibernateJpaConfiguration$$EnhancerBySpringCGLIB$$4bb137a5.jpaVendorAdapter(&lt;generated&gt;) [spring-boot-autoconfigure-2.1.3.RELEASE.jar:2.1.3.RELEASE]</span><br><span class=\"line\">\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:1.8.0_161]</span><br><span class=\"line\">\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:1.8.0_161]</span><br><span class=\"line\">\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:1.8.0_161]</span><br><span class=\"line\">\tat java.lang.reflect.Method.invoke(Method.java:498) ~[na:1.8.0_161]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:154) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:622) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:456) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1305) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1144) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:555) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:515) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:320) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:222) ~[spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:318) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:277) ~[spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1247) ~[spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1167) ~[spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:857) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:760) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:509) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1305) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1144) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:555) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:515) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:320) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:222) ~[spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:318) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:277) ~[spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1247) ~[spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1167) ~[spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:857) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:760) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:509) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1305) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1144) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:555) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:515) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:320) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:222) ~[spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:318) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:367) ~[spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveValueIfNecessary(BeanDefinitionValueResolver.java:110) ~[spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.ConstructorResolver.resolveConstructorArguments(ConstructorResolver.java:662) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:479) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1305) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1144) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:555) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:515) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveInnerBean(BeanDefinitionValueResolver.java:312) ~[spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveValueIfNecessary(BeanDefinitionValueResolver.java:131) ~[spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyPropertyValues(AbstractAutowireCapableBeanFactory.java:1665) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1417) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:592) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:515) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:320) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:222) ~[spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:318) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:277) ~[spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1247) ~[spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1167) ~[spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:857) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:760) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:218) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1325) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1171) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:555) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:515) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:320) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:222) ~[spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:318) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:277) ~[spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1247) ~[spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1167) ~[spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:857) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:760) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:509) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1305) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1144) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:555) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:515) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:320) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:222) ~[spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:318) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:204) [spring-beans-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.boot.web.servlet.ServletContextInitializerBeans.getOrderedBeansOfType(ServletContextInitializerBeans.java:235) ~[spring-boot-2.1.3.RELEASE.jar:2.1.3.RELEASE]</span><br><span class=\"line\">\tat org.springframework.boot.web.servlet.ServletContextInitializerBeans.getOrderedBeansOfType(ServletContextInitializerBeans.java:226) ~[spring-boot-2.1.3.RELEASE.jar:2.1.3.RELEASE]</span><br><span class=\"line\">\tat org.springframework.boot.web.servlet.ServletContextInitializerBeans.addServletContextInitializerBeans(ServletContextInitializerBeans.java:101) ~[spring-boot-2.1.3.RELEASE.jar:2.1.3.RELEASE]</span><br><span class=\"line\">\tat org.springframework.boot.web.servlet.ServletContextInitializerBeans.&lt;init&gt;(ServletContextInitializerBeans.java:88) ~[spring-boot-2.1.3.RELEASE.jar:2.1.3.RELEASE]</span><br><span class=\"line\">\tat org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.getServletContextInitializerBeans(ServletWebServerApplicationContext.java:261) ~[spring-boot-2.1.3.RELEASE.jar:2.1.3.RELEASE]</span><br><span class=\"line\">\tat org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.selfInitialize(ServletWebServerApplicationContext.java:234) ~[spring-boot-2.1.3.RELEASE.jar:2.1.3.RELEASE]</span><br><span class=\"line\">\tat org.springframework.boot.web.embedded.undertow.UndertowServletWebServerFactory$Initializer.onStartup(UndertowServletWebServerFactory.java:616) ~[spring-boot-2.1.3.RELEASE.jar:2.1.3.RELEASE]</span><br><span class=\"line\">\tat io.undertow.servlet.core.DeploymentManagerImpl$1.call(DeploymentManagerImpl.java:203) ~[undertow-servlet-2.0.17.Final.jar:2.0.17.Final]</span><br><span class=\"line\">\tat io.undertow.servlet.core.DeploymentManagerImpl$1.call(DeploymentManagerImpl.java:185) ~[undertow-servlet-2.0.17.Final.jar:2.0.17.Final]</span><br><span class=\"line\">\tat io.undertow.servlet.core.ServletRequestContextThreadSetupAction$1.call(ServletRequestContextThreadSetupAction.java:42) ~[undertow-servlet-2.0.17.Final.jar:2.0.17.Final]</span><br><span class=\"line\">\tat io.undertow.servlet.core.ContextClassLoaderSetupAction$1.call(ContextClassLoaderSetupAction.java:43) ~[undertow-servlet-2.0.17.Final.jar:2.0.17.Final]</span><br><span class=\"line\">\tat io.undertow.servlet.core.DeploymentManagerImpl.deploy(DeploymentManagerImpl.java:250) ~[undertow-servlet-2.0.17.Final.jar:2.0.17.Final]</span><br><span class=\"line\">\tat org.springframework.boot.web.embedded.undertow.UndertowServletWebServerFactory.createDeploymentManager(UndertowServletWebServerFactory.java:284) ~[spring-boot-2.1.3.RELEASE.jar:2.1.3.RELEASE]</span><br><span class=\"line\">\tat org.springframework.boot.web.embedded.undertow.UndertowServletWebServerFactory.getWebServer(UndertowServletWebServerFactory.java:208) ~[spring-boot-2.1.3.RELEASE.jar:2.1.3.RELEASE]</span><br><span class=\"line\">\tat org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.createWebServer(ServletWebServerApplicationContext.java:181) ~[spring-boot-2.1.3.RELEASE.jar:2.1.3.RELEASE]</span><br><span class=\"line\">\tat org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.onRefresh(ServletWebServerApplicationContext.java:154) ~[spring-boot-2.1.3.RELEASE.jar:2.1.3.RELEASE]</span><br><span class=\"line\">\tat org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:543) ~[spring-context-5.1.5.RELEASE.jar:5.1.5.RELEASE]</span><br><span class=\"line\">\tat org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:142) ~[spring-boot-2.1.3.RELEASE.jar:2.1.3.RELEASE]</span><br><span class=\"line\">\tat org.springframework.boot.SpringApplication.refresh(SpringApplication.java:775) ~[spring-boot-2.1.3.RELEASE.jar:2.1.3.RELEASE]</span><br><span class=\"line\">\tat org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:397) ~[spring-boot-2.1.3.RELEASE.jar:2.1.3.RELEASE]</span><br><span class=\"line\">\tat org.springframework.boot.SpringApplication.run(SpringApplication.java:316) ~[spring-boot-2.1.3.RELEASE.jar:2.1.3.RELEASE]</span><br><span class=\"line\">\tat org.springframework.boot.SpringApplication.run(SpringApplication.java:1260) ~[spring-boot-2.1.3.RELEASE.jar:2.1.3.RELEASE]</span><br><span class=\"line\">\tat org.springframework.boot.SpringApplication.run(SpringApplication.java:1248) ~[spring-boot-2.1.3.RELEASE.jar:2.1.3.RELEASE]</span><br><span class=\"line\">\tat run.halo.app.Application.main(Application.java:31) ~[classes/:na]</span><br><span class=\"line\">\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:1.8.0_161]</span><br><span class=\"line\">\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:1.8.0_161]</span><br><span class=\"line\">\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:1.8.0_161]</span><br><span class=\"line\">\tat java.lang.reflect.Method.invoke(Method.java:498) ~[na:1.8.0_161]</span><br><span class=\"line\">\tat org.springframework.boot.devtools.restart.RestartLauncher.run(RestartLauncher.java:49) ~[spring-boot-devtools-2.1.3.RELEASE.jar:2.1.3.RELEASE]</span><br><span class=\"line\">Caused by: java.lang.IllegalStateException: The file is locked: nio:C:/Users/Chirius/.halo/db/halo.mv.db [1.4.197/7]</span><br><span class=\"line\">\tat org.h2.mvstore.DataUtils.newIllegalStateException(DataUtils.java:870) ~[h2-1.4.197.jar:1.4.197]</span><br><span class=\"line\">\tat org.h2.mvstore.FileStore.open(FileStore.java:173) ~[h2-1.4.197.jar:1.4.197]</span><br><span class=\"line\">\tat org.h2.mvstore.MVStore.&lt;init&gt;(MVStore.java:350) ~[h2-1.4.197.jar:1.4.197]</span><br><span class=\"line\">\tat org.h2.mvstore.MVStore$Builder.open(MVStore.java:2934) ~[h2-1.4.197.jar:1.4.197]</span><br><span class=\"line\">\tat org.h2.mvstore.db.MVTableEngine$Store.open(MVTableEngine.java:155) ~[h2-1.4.197.jar:1.4.197]</span><br><span class=\"line\">\t... 152 common frames omitted</span><br></pre></td></tr></table></figure>\næ‰€ä»¥ç¬”ä¸»åœ¨è¿™é‡Œä¸æ¨èè¿™ç§æ–¹æ³•ï¼Œå› ä¸ºä¼šå ç”¨h2æ•°æ®åº“è¿æ¥ï¼Œç”¨äº†è¿™ç§æ•°æ®åº“è¿æ¥å°±ä¸èƒ½å¯åŠ¨é¡¹ç›®ï¼Œåä¹‹äº¦ç„¶ã€‚</li>\n</ol>\n<hr>\n<ol start=\"2\">\n<li>ä½¿ç”¨H2 Consoleè¿›è¡ŒæŸ¥çœ‹ï¼Œç”±äºé¡¹ç›®æ˜¯SpringBootçš„ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œåªéœ€è¦ä¿®æ”¹ç›¸åº”é…ç½®å³å¯ï¼Œç”±<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">h2:</span><br><span class=\"line\">    console:</span><br><span class=\"line\">      settings:</span><br><span class=\"line\">        web-allow-others: false</span><br><span class=\"line\">      path: &#x2F;h2-console</span><br><span class=\"line\">      enabled: false</span><br></pre></td></tr></table></figure>\næ”¹ä¸º<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">h2:</span><br><span class=\"line\">    console:</span><br><span class=\"line\">      settings:</span><br><span class=\"line\">        web-allow-others: false</span><br><span class=\"line\">      path: &#x2F;h2-console</span><br><span class=\"line\">      enabled: false</span><br></pre></td></tr></table></figure>\nå³å¯ï¼Œå¯åŠ¨é¡¹ç›®ï¼Œç„¶ååœ¨é¡¹ç›®è®¿é—®è·¯å¾„åé¢åŠ ä¸Šé…ç½®çš„path**/h2-console**å°±å¯ä»¥æŸ¥çœ‹å…·ä½“ç»“æœäº†ï¼š<br><img src=\"https://image.eelve.com/eblog/12344-e3c905ae1b794528af9706227afa9b38.png\" alt=\"é€šè¿‡H2 ConsoleæŸ¥çœ‹çš„ç»“æœ\"></li>\n</ol>\n<hr>\n<p><img src=\"https://image.eelve.com/eblog/eblog-b269767ff45b4e01a1c380e38898c1c0.png\" alt=\"è–ç±³ç¬”è®°\"></p>\n","raw":null,"categories":[{"name":"springboot","path":"api/categories/springboot.json"}],"tags":[{"name":"java","path":"api/tags/java.json"},{"name":"springboot","path":"api/tags/springboot.json"},{"name":"h2","path":"api/tags/h2.json"}]},{"title":"æµ…æSpring Bootå•ä½“åº”ç”¨ç†”æ–­æŠ€æœ¯","slug":"æµ…æSpring-Bootå•ä½“åº”ç”¨ç†”æ–­æŠ€æœ¯","date":"2021-01-20T12:20:20.000Z","updated":"2021-04-19T06:44:39.305Z","comments":true,"path":"api/articles/æµ…æSpring-Bootå•ä½“åº”ç”¨ç†”æ–­æŠ€æœ¯.json","excerpt":null,"keywords":"å—å›½è–ç±³","cover":"https://image.eelve.com/eblog/2021012001.png","content":"<p>ã€<strong>å‰é¢çš„è¯</strong>ã€‘æœ€è¿‘åœ¨çœ‹æœåŠ¡ç†”æ–­çš„ç›¸å…³æŠ€æœ¯ï¼Œä¸‹é¢å°±æ¥æ€»ç»“ä¸€ä¸‹ã€‚</p>\n<h1 id=\"å£¹ã€å…¥å›´æ–¹æ¡ˆ\"><a href=\"#å£¹ã€å…¥å›´æ–¹æ¡ˆ\" class=\"headerlink\" title=\"å£¹ã€å…¥å›´æ–¹æ¡ˆ\"></a>å£¹ã€å…¥å›´æ–¹æ¡ˆ</h1><ul>\n<li>Sentinel<ul>\n<li><a href=\"https://github.com/alibaba/Sentinel\">githubåœ°å€</a></li>\n<li><a href=\"https://sentinelguard.io/zh-cn/docs/introduction.html\">https://sentinelguard.io/zh-cn/docs/introduction.html</a></li>\n<li>é˜¿é‡Œå‡ºå“ï¼ŒSpring Cloud Alibabaé™æµç»„ä»¶ï¼Œç›®å‰æŒç»­æ›´æ–°ä¸­</li>\n<li>è‡ªå¸¦Dashboardï¼Œå¯ä»¥æŸ¥çœ‹æ¥å£Qpsç­‰ï¼Œå¹¶ä¸”å¯ä»¥åŠ¨æ€ä¿®æ”¹å„ç§è§„åˆ™</li>\n<li>æµé‡æ§åˆ¶ï¼Œç›´æ¥é™æµã€å†·å¯åŠ¨ã€æ’é˜Ÿ</li>\n<li>ç†”æ–­é™çº§ï¼Œé™åˆ¶å¹¶å‘é™åˆ¶æ•°å’Œç›¸åº”æ—¶é—´</li>\n<li>ç³»ç»Ÿè´Ÿè½½ä¿æŠ¤ï¼Œæä¾›ç³»ç»Ÿçº§åˆ«é˜²æŠ¤ï¼Œé™åˆ¶æ€»ä½“CPUç­‰</li>\n<li>ä¸»è¦æ ¸å¿ƒï¼šèµ„æºï¼Œè§„åˆ™ï¼ˆæµé‡æ§åˆ¶è§„åˆ™ã€ç†”æ–­é™çº§è§„åˆ™ã€ç³»ç»Ÿä¿æŠ¤è§„åˆ™ã€æ¥æºè®¿é—®æ§åˆ¶è§„åˆ™ å’Œ çƒ­ç‚¹å‚æ•°è§„åˆ™ã€‚ï¼‰ï¼Œå’ŒæŒ‡æ ‡</li>\n<li>æ–‡æ¡£éå¸¸æ¸…æ™°å’Œè¯¦ç»†ï¼Œä¸­æ–‡</li>\n<li>æ”¯æŒåŠ¨æ€è§„åˆ™ï¼ˆæ¨æ¨¡å¼å’Œæ‹‰æ¨¡å¼ï¼‰</li>\n</ul>\n</li>\n<li>Hystrix<ul>\n<li><a href=\"https://github.com/Netflix/Hystrix\">githubåœ°å€</a></li>\n<li><a href=\"https://github.com/Netflix/Hystrix/wiki\">https://github.com/Netflix/Hystrix/wiki</a></li>\n<li>Netflixå‡ºå“ï¼ŒSpring Cloud Netflixé™æµç»„ä»¶ï¼Œå·²ç»åœæ­¢æ–°ç‰¹æ€§å¼€å‘ï¼Œåªè¿›è¡Œbugä¿®å¤ï¼Œæœ€è¿‘æ›´æ–°ä¸º2018å¹´ï¼ŒåŠŸèƒ½ç¨³å®š</li>\n<li>æœ‰ç®€å•çš„dashboardé¡µé¢</li>\n<li>ä»¥éš”ç¦»å’Œç†”æ–­ä¸ºä¸»çš„å®¹é”™æœºåˆ¶ï¼Œè¶…æ—¶æˆ–è¢«ç†”æ–­çš„è°ƒç”¨å°†ä¼šå¿«é€Ÿå¤±è´¥ï¼Œå¹¶å¯ä»¥æä¾› fallback æœºåˆ¶çš„åˆä»£ç†”æ–­æ¡†æ¶ï¼Œå¼‚å¸¸ç»Ÿè®¡åŸºäºæ»‘åŠ¨çª—å£</li>\n</ul>\n</li>\n<li>resilience4j<ul>\n<li><a href=\"https://github.com/resilience4j/resilience4j\">githubåœ°å€</a></li>\n<li><a href=\"https://resilience4j.readme.io/docs\">https://resilience4j.readme.io/docs</a></li>\n<li>æ˜¯ä¸€æ¬¾è½»é‡ã€ç®€å•ï¼Œå¹¶ä¸”æ–‡æ¡£éå¸¸æ¸…æ™°ã€ä¸°å¯Œçš„ç†”æ–­å·¥å…·ã€‚æ˜¯Hystrixæ›¿ä»£å“ï¼Œå®ç°æ€è·¯å’ŒHystrixä¸€è‡´ï¼Œç›®å‰æŒç»­æ›´æ–°ä¸­</li>\n<li>éœ€è¦è‡ªå·±å¯¹micrometerã€prometheusä»¥åŠDropwizard metricsè¿›è¡Œæ•´åˆ</li>\n<li>CircuitBreaker ç†”æ–­</li>\n<li>Bulkhead éš”ç¦»</li>\n<li>RateLimiter QPSé™åˆ¶</li>\n<li>Retry é‡è¯•</li>\n<li>TimeLimiter è¶…æ—¶é™åˆ¶</li>\n<li>Cache ç¼“å­˜</li>\n</ul>\n</li>\n<li>è‡ªå·±å®ç°(åŸºäºGuava)<ul>\n<li>åŸºäºGuavaçš„ä»¤ç‰Œæ¡¶ï¼Œå¯ä»¥è½»æ¾å®ç°å¯¹QPSè¿›è¡Œé™æµ</li>\n</ul>\n</li>\n</ul>\n<h1 id=\"è´°ã€æŠ€æœ¯å¯¹æ¯”\"><a href=\"#è´°ã€æŠ€æœ¯å¯¹æ¯”\" class=\"headerlink\" title=\"è´°ã€æŠ€æœ¯å¯¹æ¯”\"></a>è´°ã€æŠ€æœ¯å¯¹æ¯”</h1><table>\n<thead>\n<tr>\n<th></th>\n<th><strong>Sentinel</strong></th>\n<th><strong>Hystrix</strong></th>\n<th><strong>resilience4j</strong></th>\n<th>ä½¿ç”¨Guavaå®ç°</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>éš”ç¦»ç­–ç•¥</td>\n<td>ä¿¡å·é‡éš”ç¦»ï¼ˆå¹¶å‘çº¿ç¨‹æ•°é™æµï¼‰</td>\n<td>çº¿ç¨‹æ± éš”ç¦»/ä¿¡å·é‡éš”ç¦»</td>\n<td>ä¿¡å·é‡éš”ç¦»</td>\n<td></td>\n</tr>\n<tr>\n<td>ç†”æ–­é™çº§ç­–ç•¥</td>\n<td>åŸºäºå“åº”æ—¶é—´ã€å¼‚å¸¸æ¯”ç‡ã€å¼‚å¸¸æ•°</td>\n<td>åŸºäºå¼‚å¸¸æ¯”ç‡</td>\n<td>åŸºäºå¼‚å¸¸æ¯”ç‡ã€å“åº”æ—¶é—´</td>\n<td></td>\n</tr>\n<tr>\n<td>å®æ—¶ç»Ÿè®¡å®ç°</td>\n<td>æ»‘åŠ¨çª—å£ï¼ˆLeapArrayï¼‰</td>\n<td>æ»‘åŠ¨çª—å£ï¼ˆåŸºäº RxJavaï¼‰</td>\n<td>Ring Bit Buffer</td>\n<td>ä»¤ç‰Œæ¡¶</td>\n</tr>\n<tr>\n<td>åŠ¨æ€è§„åˆ™é…ç½®</td>\n<td>æ”¯æŒå¤šç§æ•°æ®æº</td>\n<td>æ”¯æŒå¤šç§æ•°æ®æº</td>\n<td>æœ‰é™æ”¯æŒ</td>\n<td></td>\n</tr>\n<tr>\n<td>æ‰©å±•æ€§</td>\n<td>å¤šä¸ªæ‰©å±•ç‚¹</td>\n<td>æ’ä»¶çš„å½¢å¼</td>\n<td>æ¥å£çš„å½¢å¼</td>\n<td></td>\n</tr>\n<tr>\n<td>åŸºäºæ³¨è§£çš„æ”¯æŒ</td>\n<td>æ”¯æŒ</td>\n<td>æ”¯æŒ</td>\n<td>æ”¯æŒ</td>\n<td>æ”¯æŒ</td>\n</tr>\n<tr>\n<td>å•æœºé™æµ</td>\n<td>åŸºäº QPSï¼Œæ”¯æŒåŸºäºè°ƒç”¨å…³ç³»çš„é™æµ</td>\n<td>æœ‰é™çš„æ”¯æŒ</td>\n<td>Rate Limiter</td>\n<td>åŸºäº QPS</td>\n</tr>\n<tr>\n<td>é›†ç¾¤æµæ§</td>\n<td>æ”¯æŒ</td>\n<td>ä¸æ”¯æŒ</td>\n<td>ä¸æ”¯æŒ</td>\n<td></td>\n</tr>\n<tr>\n<td>æµé‡æ•´å½¢</td>\n<td>æ”¯æŒé¢„çƒ­æ¨¡å¼ä¸åŒ€é€Ÿæ’é˜Ÿæ§åˆ¶æ•ˆæœ</td>\n<td>ä¸æ”¯æŒ</td>\n<td>ç®€å•çš„ Rate Limiter æ¨¡å¼</td>\n<td></td>\n</tr>\n<tr>\n<td>ç³»ç»Ÿè‡ªé€‚åº”ä¿æŠ¤</td>\n<td>æ”¯æŒ</td>\n<td>ä¸æ”¯æŒ</td>\n<td>ä¸æ”¯æŒ</td>\n<td></td>\n</tr>\n<tr>\n<td>çƒ­ç‚¹è¯†åˆ«/é˜²æŠ¤</td>\n<td>æ”¯æŒ</td>\n<td>ä¸æ”¯æŒ</td>\n<td>ä¸æ”¯æŒ</td>\n<td></td>\n</tr>\n<tr>\n<td>Service Mesh æ”¯æŒ</td>\n<td>æ”¯æŒ Envoy/Istio</td>\n<td>ä¸æ”¯æŒ</td>\n<td>ä¸æ”¯æŒ</td>\n<td></td>\n</tr>\n<tr>\n<td>æ§åˆ¶å°</td>\n<td>æä¾›å¼€ç®±å³ç”¨çš„æ§åˆ¶å°ï¼Œå¯é…ç½®è§„åˆ™ã€å®æ—¶ç›‘æ§ã€æœºå™¨å‘ç°ç­‰</td>\n<td>ç®€å•çš„ç›‘æ§æŸ¥çœ‹</td>\n<td>ä¸æä¾›æ§åˆ¶å°ï¼Œå¯å¯¹æ¥å…¶å®ƒç›‘æ§ç³»ç»Ÿ</td>\n<td></td>\n</tr>\n<tr>\n<td>æ˜¯å¦æ”¯æŒé»˜è®¤è§„åˆ™</td>\n<td>ä¸æ”¯æŒï¼Œéœ€è¦é’ˆå¯¹æ¯ä¸ªæ¥å£é…ç½®è§„åˆ™</td>\n<td>æ”¯æŒ</td>\n<td>æ”¯æŒ</td>\n<td></td>\n</tr>\n<tr>\n<td>æ˜¯å¦æ”¯æŒè¿‡æ»¤å¼‚å¸¸</td>\n<td>æ³¨è§£å•ä¸ªæ¥å£æ”¯æŒ</td>\n<td>æ³¨è§£å’Œå…¨å±€é»˜è®¤é…ç½®</td>\n<td>æ³¨è§£å’Œå…¨å±€é»˜è®¤é…ç½®</td>\n<td></td>\n</tr>\n</tbody></table>\n<h1 id=\"åã€åº”ç”¨æ”¹é€ \"><a href=\"#åã€åº”ç”¨æ”¹é€ \" class=\"headerlink\" title=\"åã€åº”ç”¨æ”¹é€ \"></a>åã€åº”ç”¨æ”¹é€ </h1><h2 id=\"3-1ã€sentinel\"><a href=\"#3-1ã€sentinel\" class=\"headerlink\" title=\"3.1ã€sentinel\"></a>3.1ã€sentinel</h2><h3 id=\"3-1-1ã€å¼•å…¥ä¾èµ–\"><a href=\"#3-1-1ã€å¼•å…¥ä¾èµ–\" class=\"headerlink\" title=\"3.1.1ã€å¼•å…¥ä¾èµ–\"></a>3.1.1ã€å¼•å…¥ä¾èµ–</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;dependency&gt;</span><br><span class=\"line\">    &lt;groupId&gt;com.alibaba.cloud&lt;&#x2F;groupId&gt;</span><br><span class=\"line\">    &lt;artifactId&gt;spring-cloud-starter-alibaba-sentinel&lt;&#x2F;artifactId&gt;</span><br><span class=\"line\">    &lt;version&gt;2.0.3.RELEASE&lt;&#x2F;version&gt;</span><br><span class=\"line\">&lt;&#x2F;dependency&gt;</span><br></pre></td></tr></table></figure>\n<h3 id=\"3-1-2ã€æ”¹é€ æ¥å£æˆ–è€…serviceå±‚\"><a href=\"#3-1-2ã€æ”¹é€ æ¥å£æˆ–è€…serviceå±‚\" class=\"headerlink\" title=\"3.1.2ã€æ”¹é€ æ¥å£æˆ–è€…serviceå±‚\"></a>3.1.2ã€æ”¹é€ æ¥å£æˆ–è€…serviceå±‚</h3><blockquote>\n<p>@SentinelResource(value = â€œallInfosâ€,fallback = â€œerrorReturnâ€)</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Target(&#123;ElementType.METHOD, ElementType.TYPE&#125;)</span></span><br><span class=\"line\"><span class=\"meta\">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class=\"line\"><span class=\"meta\">@Inherited</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> SentinelResource &#123;</span><br><span class=\"line\">    <span class=\"comment\">//èµ„æºåç§°</span></span><br><span class=\"line\">    <span class=\"function\">String <span class=\"title\">value</span><span class=\"params\">()</span> <span class=\"keyword\">default</span> &quot;&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//æµé‡æ–¹å‘</span></span><br><span class=\"line\">    <span class=\"function\">EntryType <span class=\"title\">entryType</span><span class=\"params\">()</span> <span class=\"keyword\">default</span> EntryType.OUT</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//èµ„æºç±»å‹</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">resourceType</span><span class=\"params\">()</span> <span class=\"keyword\">default</span> 0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//å¼‚å¸¸å¤„ç†æ–¹æ³•</span></span><br><span class=\"line\">    <span class=\"function\">String <span class=\"title\">blockHandler</span><span class=\"params\">()</span> <span class=\"keyword\">default</span> &quot;&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//å¼‚å¸¸å¤„ç†ç±»</span></span><br><span class=\"line\">    Class&lt;?&gt;[] blockHandlerClass() <span class=\"keyword\">default</span> &#123;&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//ç†”æ–­æ–¹æ³•</span></span><br><span class=\"line\">    <span class=\"function\">String <span class=\"title\">fallback</span><span class=\"params\">()</span> <span class=\"keyword\">default</span> &quot;&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//é»˜è®¤ç†”æ–­æ–¹æ³•</span></span><br><span class=\"line\">    <span class=\"function\">String <span class=\"title\">defaultFallback</span><span class=\"params\">()</span> <span class=\"keyword\">default</span> &quot;&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//ç†”æ–­ç±»</span></span><br><span class=\"line\">    Class&lt;?&gt;[] fallbackClass() <span class=\"keyword\">default</span> &#123;&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//ç»Ÿè®¡å¼‚å¸¸</span></span><br><span class=\"line\">    Class&lt;? extends Throwable&gt;[] exceptionsToTrace() <span class=\"keyword\">default</span> &#123;Throwable.class&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//å¿½ç•¥å¼‚å¸¸</span></span><br><span class=\"line\">    Class&lt;? extends Throwable&gt;[] exceptionsToIgnore() <span class=\"keyword\">default</span> &#123;&#125;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@RequestMapping(&quot;/get&quot;)</span></span><br><span class=\"line\"><span class=\"meta\">@ResponseBody</span></span><br><span class=\"line\"><span class=\"meta\">@SentinelResource(value = &quot;allInfos&quot;,fallback = &quot;errorReturn&quot;)</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> JsonResult <span class=\"title\">allInfos</span><span class=\"params\">(HttpServletRequest request, HttpServletResponse response, <span class=\"meta\">@RequestParam</span> Integer num)</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (num % <span class=\"number\">2</span> == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">                log.info(<span class=\"string\">&quot;num % 2 == 0&quot;</span>);</span><br><span class=\"line\">                <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> BaseException(<span class=\"string\">&quot;something bad with 2&quot;</span>, <span class=\"number\">400</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> JsonResult.ok();</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (ProgramException e) &#123;</span><br><span class=\"line\">            log.info(<span class=\"string\">&quot;error&quot;</span>);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> JsonResult.error(<span class=\"string\">&quot;error&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"3-1-3ã€é’ˆå¯¹æ¥å£é…ç½®ç†”æ–­æ–¹æ³•æˆ–è€…é™æµæ–¹æ³•\"><a href=\"#3-1-3ã€é’ˆå¯¹æ¥å£é…ç½®ç†”æ–­æ–¹æ³•æˆ–è€…é™æµæ–¹æ³•\" class=\"headerlink\" title=\"3.1.3ã€é’ˆå¯¹æ¥å£é…ç½®ç†”æ–­æ–¹æ³•æˆ–è€…é™æµæ–¹æ³•\"></a>3.1.3ã€é’ˆå¯¹æ¥å£é…ç½®ç†”æ–­æ–¹æ³•æˆ–è€…é™æµæ–¹æ³•</h3><blockquote>\n<p>é»˜è®¤è¿‡æ»¤æ‹¦æˆªæ‰€æœ‰Controlleræ¥å£</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * é™æµï¼Œå‚æ•°éœ€è¦å’Œæ–¹æ³•ä¿æŒä¸€è‡´</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> request</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> response</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> num</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> BlockException</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> JsonResult <span class=\"title\">errorReturn</span><span class=\"params\">(HttpServletRequest request, HttpServletResponse response, <span class=\"meta\">@RequestParam</span> Integer num)</span> <span class=\"keyword\">throws</span> BlockException </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> JsonResult.error(<span class=\"string\">&quot;error é™æµ&quot;</span> + num );</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * ç†”æ–­ï¼Œå‚æ•°éœ€è¦å’Œæ–¹æ³•ä¿æŒä¸€ç›´ï¼Œå¹¶ä¸”éœ€è¦æ·»åŠ BlockExceptionå¼‚å¸¸</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> request</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> response</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> num</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> b</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> BlockException</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> JsonResult <span class=\"title\">errorReturn</span><span class=\"params\">(HttpServletRequest request, HttpServletResponse response, <span class=\"meta\">@RequestParam</span> Integer num,BlockException b)</span> <span class=\"keyword\">throws</span> BlockException </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> JsonResult.error(<span class=\"string\">&quot;error ç†”æ–­&quot;</span> + num );</span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>æ³¨æ„ä¹Ÿå¯ä»¥ä¸é…ç½®é™æµæˆ–è€…ç†”æ–­æ–¹æ³•ã€‚é€šè¿‡å…¨å±€å¼‚å¸¸å»æ•è·<strong>UndeclaredThrowableException</strong>æˆ–è€…<strong>BlockException</strong>é¿å…å¤§é‡çš„å¼€å‘é‡</p>\n</blockquote>\n<h3 id=\"3-1-4ã€æ¥å…¥dashboard\"><a href=\"#3-1-4ã€æ¥å…¥dashboard\" class=\"headerlink\" title=\"3.1.4ã€æ¥å…¥dashboard\"></a>3.1.4ã€æ¥å…¥dashboard</h3><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">spring:</span></span><br><span class=\"line\">  <span class=\"attr\">cloud:</span></span><br><span class=\"line\">    <span class=\"attr\">sentinel:</span></span><br><span class=\"line\">      <span class=\"attr\">transport:</span></span><br><span class=\"line\">        <span class=\"attr\">port:</span> <span class=\"number\">8719</span></span><br><span class=\"line\">        <span class=\"attr\">dashboard:</span> <span class=\"string\">localhost:8080</span></span><br></pre></td></tr></table></figure>\n<p><img src=\"https://image.eelve.com/eblog/2021012001.png\" alt=\"sentinel\"></p>\n<h3 id=\"3-1-5ã€è§„åˆ™æŒä¹…åŒ–å’ŒåŠ¨æ€æ›´æ–°\"><a href=\"#3-1-5ã€è§„åˆ™æŒä¹…åŒ–å’ŒåŠ¨æ€æ›´æ–°\" class=\"headerlink\" title=\"3.1.5ã€è§„åˆ™æŒä¹…åŒ–å’ŒåŠ¨æ€æ›´æ–°\"></a>3.1.5ã€è§„åˆ™æŒä¹…åŒ–å’ŒåŠ¨æ€æ›´æ–°</h3><blockquote>\n<p>æ¥å…¥é…ç½®ä¸­å¿ƒå¦‚ï¼šzookeeperç­‰ç­‰ï¼Œå¹¶å¯¹è§„åˆ™é‡‡ç”¨æ¨æ¨¡å¼</p>\n</blockquote>\n<h2 id=\"3-2ã€hystrix\"><a href=\"#3-2ã€hystrix\" class=\"headerlink\" title=\"3.2ã€hystrix\"></a>3.2ã€hystrix</h2><h3 id=\"3-2-1ã€å¼•å…¥ä¾èµ–\"><a href=\"#3-2-1ã€å¼•å…¥ä¾èµ–\" class=\"headerlink\" title=\"3.2.1ã€å¼•å…¥ä¾èµ–\"></a>3.2.1ã€å¼•å…¥ä¾èµ–</h3> <figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;dependency&gt;</span><br><span class=\"line\">    &lt;groupId&gt;org.springframework.boot&lt;&#x2F;groupId&gt;</span><br><span class=\"line\">    &lt;artifactId&gt;spring-boot-starter-actuator&lt;&#x2F;artifactId&gt;</span><br><span class=\"line\">&lt;&#x2F;dependency&gt;</span><br><span class=\"line\">&lt;dependency&gt;</span><br><span class=\"line\">    &lt;groupId&gt;org.springframework.cloud&lt;&#x2F;groupId&gt;</span><br><span class=\"line\">    &lt;artifactId&gt;spring-cloud-starter-netflix-hystrix-dashboard&lt;&#x2F;artifactId&gt;</span><br><span class=\"line\">    &lt;version&gt;2.0.4.RELEASE&lt;&#x2F;version&gt;</span><br><span class=\"line\">&lt;&#x2F;dependency&gt;</span><br><span class=\"line\">&lt;dependency&gt;</span><br><span class=\"line\">    &lt;groupId&gt;org.springframework.cloud&lt;&#x2F;groupId&gt;</span><br><span class=\"line\">    &lt;artifactId&gt;spring-cloud-starter-netflix-hystrix&lt;&#x2F;artifactId&gt;</span><br><span class=\"line\">    &lt;version&gt;2.0.4.RELEASE&lt;&#x2F;version&gt;</span><br><span class=\"line\">&lt;&#x2F;dependency&gt;</span><br></pre></td></tr></table></figure>\n<h3 id=\"3-2-2ã€æ”¹é€ æ¥å£\"><a href=\"#3-2-2ã€æ”¹é€ æ¥å£\" class=\"headerlink\" title=\"3.2.2ã€æ”¹é€ æ¥å£\"></a>3.2.2ã€æ”¹é€ æ¥å£</h3><blockquote>\n<p>@HystrixCommand(fallbackMethod = â€œtimeOutErrorâ€)</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Target(&#123;ElementType.METHOD&#125;)</span></span><br><span class=\"line\"><span class=\"meta\">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class=\"line\"><span class=\"meta\">@Inherited</span></span><br><span class=\"line\"><span class=\"meta\">@Documented</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> HystrixCommand &#123;</span><br><span class=\"line\">    <span class=\"function\">String <span class=\"title\">groupKey</span><span class=\"params\">()</span> <span class=\"keyword\">default</span> &quot;&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\">String <span class=\"title\">commandKey</span><span class=\"params\">()</span> <span class=\"keyword\">default</span> &quot;&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\">String <span class=\"title\">threadPoolKey</span><span class=\"params\">()</span> <span class=\"keyword\">default</span> &quot;&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\">String <span class=\"title\">fallbackMethod</span><span class=\"params\">()</span> <span class=\"keyword\">default</span> &quot;&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    HystrixProperty[] commandProperties() <span class=\"keyword\">default</span> &#123;&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    HystrixProperty[] threadPoolProperties() <span class=\"keyword\">default</span> &#123;&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    Class&lt;? extends Throwable&gt;[] ignoreExceptions() <span class=\"keyword\">default</span> &#123;&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\">ObservableExecutionMode <span class=\"title\">observableExecutionMode</span><span class=\"params\">()</span> <span class=\"keyword\">default</span> ObservableExecutionMode.EAGER</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    HystrixException[] raiseHystrixExceptions() <span class=\"keyword\">default</span> &#123;&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\">String <span class=\"title\">defaultFallback</span><span class=\"params\">()</span> <span class=\"keyword\">default</span> &quot;&quot;</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@RequestMapping(&quot;/get&quot;)</span></span><br><span class=\"line\"><span class=\"meta\">@ResponseBody</span></span><br><span class=\"line\"><span class=\"meta\">@HystrixCommand(fallbackMethod = &quot;fallbackMethod&quot;)</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> JsonResult <span class=\"title\">allInfos</span><span class=\"params\">(HttpServletRequest request, HttpServletResponse response, <span class=\"meta\">@RequestParam</span> Integer num)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (num % <span class=\"number\">3</span> == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">            log.info(<span class=\"string\">&quot;num % 3 == 0&quot;</span>);</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> BaseException(<span class=\"string\">&quot;something bad whitch 3&quot;</span>, <span class=\"number\">400</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> JsonResult.ok();</span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span> (ProgramException | InterruptedException exception) &#123;</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;error&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> JsonResult.error(<span class=\"string\">&quot;error&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"3-2-3ã€é’ˆå¯¹æ¥å£é…ç½®ç†”æ–­æ–¹æ³•\"><a href=\"#3-2-3ã€é’ˆå¯¹æ¥å£é…ç½®ç†”æ–­æ–¹æ³•\" class=\"headerlink\" title=\"3.2.3ã€é’ˆå¯¹æ¥å£é…ç½®ç†”æ–­æ–¹æ³•\"></a>3.2.3ã€é’ˆå¯¹æ¥å£é…ç½®ç†”æ–­æ–¹æ³•</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * è¯¥æ–¹æ³•æ˜¯ç†”æ–­å›è°ƒæ–¹æ³•ï¼Œå‚æ•°éœ€è¦å’Œæ¥å£ä¿æŒä¸€è‡´</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> request</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> response</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> num</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> JsonResult <span class=\"title\">fallbackMethod</span><span class=\"params\">(HttpServletRequest request, HttpServletResponse response, <span class=\"meta\">@RequestParam</span> Integer num)</span> </span>&#123;</span><br><span class=\"line\">    response.setStatus(<span class=\"number\">500</span>);</span><br><span class=\"line\">    log.info(<span class=\"string\">&quot;å‘ç”Ÿäº†ç†”æ–­ï¼ï¼&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> JsonResult.error(<span class=\"string\">&quot;ç†”æ–­&quot;</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"3-2-4ã€é…ç½®é»˜è®¤ç­–ç•¥\"><a href=\"#3-2-4ã€é…ç½®é»˜è®¤ç­–ç•¥\" class=\"headerlink\" title=\"3.2.4ã€é…ç½®é»˜è®¤ç­–ç•¥\"></a>3.2.4ã€é…ç½®é»˜è®¤ç­–ç•¥</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hystrix:</span><br><span class=\"line\">  command:</span><br><span class=\"line\">    default:</span><br><span class=\"line\">      execution:</span><br><span class=\"line\">        isolation:</span><br><span class=\"line\">          strategy: THREAD</span><br><span class=\"line\">          thread:</span><br><span class=\"line\">            # çº¿ç¨‹è¶…æ—¶15ç§’,è°ƒç”¨Fallbackæ–¹æ³•</span><br><span class=\"line\">            timeoutInMilliseconds: 15000</span><br><span class=\"line\">      metrics:</span><br><span class=\"line\">        rollingStats:</span><br><span class=\"line\">          timeInMilliseconds: 15000</span><br><span class=\"line\">      circuitBreaker:</span><br><span class=\"line\">        # 10ç§’å†…å‡ºç°3ä¸ªä»¥ä¸Šè¯·æ±‚(å·²ä¸´è¿‘é˜€å€¼),å¹¶ä¸”å‡ºé”™ç‡åœ¨50%ä»¥ä¸Š,å¼€å¯æ–­è·¯å™¨.æ–­å¼€æœåŠ¡,è°ƒç”¨Fallbackæ–¹æ³•</span><br><span class=\"line\">        requestVolumeThreshold: 3</span><br><span class=\"line\">        sleepWindowInMilliseconds: 10000</span><br></pre></td></tr></table></figure>\n<h3 id=\"3-2-5ã€æ¥å…¥ç›‘æ§\"><a href=\"#3-2-5ã€æ¥å…¥ç›‘æ§\" class=\"headerlink\" title=\"3.2.5ã€æ¥å…¥ç›‘æ§\"></a>3.2.5ã€æ¥å…¥ç›‘æ§</h3><p><img src=\"https://image.eelve.com/eblog/2021012002.png\" alt=\"hystrix\"></p>\n<p><img src=\"https://image.eelve.com/eblog/2021012003.png\" alt=\"hystrixç¤ºæ„å›¾\"></p>\n<blockquote>\n<p>æ›²çº¿ï¼šç”¨æ¥è®°å½•2åˆ†é’Ÿå†…æµé‡çš„ç›¸å¯¹å˜åŒ–ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å®ƒæ¥è§‚å¯Ÿåˆ°æµé‡çš„ä¸Šå‡å’Œä¸‹é™è¶‹åŠ¿ã€‚</p>\n</blockquote>\n<blockquote>\n<p><strong>é›†ç¾¤ç›‘æ§éœ€è¦ç”¨åˆ°æ³¨å†Œä¸­å¿ƒ</strong></p>\n</blockquote>\n<h2 id=\"3-3ã€resilience4j\"><a href=\"#3-3ã€resilience4j\" class=\"headerlink\" title=\"3.3ã€resilience4j\"></a>3.3ã€resilience4j</h2><h3 id=\"3-3-1ã€å¼•å…¥ä¾èµ–\"><a href=\"#3-3-1ã€å¼•å…¥ä¾èµ–\" class=\"headerlink\" title=\"3.3.1ã€å¼•å…¥ä¾èµ–\"></a>3.3.1ã€å¼•å…¥ä¾èµ–</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;dependency&gt;</span><br><span class=\"line\">    &lt;groupId&gt;org.springframework.boot&lt;&#x2F;groupId&gt;</span><br><span class=\"line\">    &lt;artifactId&gt;spring-boot-starter-web&lt;&#x2F;artifactId&gt;</span><br><span class=\"line\">&lt;&#x2F;dependency&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;dependency&gt;</span><br><span class=\"line\">    &lt;groupId&gt;org.springframework.boot&lt;&#x2F;groupId&gt;</span><br><span class=\"line\">    &lt;artifactId&gt;spring-boot-starter-test&lt;&#x2F;artifactId&gt;</span><br><span class=\"line\">    &lt;scope&gt;test&lt;&#x2F;scope&gt;</span><br><span class=\"line\">&lt;&#x2F;dependency&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;dependency&gt;</span><br><span class=\"line\">    &lt;groupId&gt;io.github.resilience4j&lt;&#x2F;groupId&gt;</span><br><span class=\"line\">    &lt;artifactId&gt;resilience4j-spring-boot2&lt;&#x2F;artifactId&gt;</span><br><span class=\"line\">    &lt;version&gt;1.6.1&lt;&#x2F;version&gt;</span><br><span class=\"line\">&lt;&#x2F;dependency&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;dependency&gt;</span><br><span class=\"line\">    &lt;groupId&gt;io.github.resilience4j&lt;&#x2F;groupId&gt;</span><br><span class=\"line\">    &lt;artifactId&gt;resilience4j-bulkhead&lt;&#x2F;artifactId&gt;</span><br><span class=\"line\">    &lt;version&gt;1.6.1&lt;&#x2F;version&gt;</span><br><span class=\"line\">&lt;&#x2F;dependency&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;dependency&gt;</span><br><span class=\"line\">    &lt;groupId&gt;io.github.resilience4j&lt;&#x2F;groupId&gt;</span><br><span class=\"line\">    &lt;artifactId&gt;resilience4j-ratelimiter&lt;&#x2F;artifactId&gt;</span><br><span class=\"line\">    &lt;version&gt;1.6.1&lt;&#x2F;version&gt;</span><br><span class=\"line\">&lt;&#x2F;dependency&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;dependency&gt;</span><br><span class=\"line\">    &lt;groupId&gt;io.github.resilience4j&lt;&#x2F;groupId&gt;</span><br><span class=\"line\">    &lt;artifactId&gt;resilience4j-timelimiter&lt;&#x2F;artifactId&gt;</span><br><span class=\"line\">    &lt;version&gt;1.6.1&lt;&#x2F;version&gt;</span><br><span class=\"line\">&lt;&#x2F;dependency&gt;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>å¯ä»¥æŒ‰éœ€è¦å¼•å…¥ï¼šbulkheadï¼Œratelimiterï¼Œtimelimiterç­‰</p>\n</blockquote>\n<h3 id=\"3-3-2ã€æ”¹é€ æ¥å£\"><a href=\"#3-3-2ã€æ”¹é€ æ¥å£\" class=\"headerlink\" title=\"3.3.2ã€æ”¹é€ æ¥å£\"></a>3.3.2ã€æ”¹é€ æ¥å£</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@RequestMapping(&quot;/get&quot;)</span></span><br><span class=\"line\"><span class=\"meta\">@ResponseBody</span></span><br><span class=\"line\"><span class=\"comment\">//@TimeLimiter(name = &quot;BulkheadA&quot;,fallbackMethod = &quot;fallbackMethod&quot;)</span></span><br><span class=\"line\"><span class=\"meta\">@CircuitBreaker(name = &quot;BulkheadA&quot;,fallbackMethod = &quot;fallbackMethod&quot;)</span></span><br><span class=\"line\"><span class=\"meta\">@Bulkhead(name = &quot;BulkheadA&quot;,fallbackMethod = &quot;fallbackMethod&quot;)</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> JsonResult <span class=\"title\">allInfos</span><span class=\"params\">(HttpServletRequest request, HttpServletResponse response, <span class=\"meta\">@RequestParam</span> Integer num)</span></span>&#123;</span><br><span class=\"line\">    log.info(<span class=\"string\">&quot;param-----&gt;&quot;</span> + num);</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">//Thread.sleep(num);</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (num % <span class=\"number\">2</span> == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">            log.info(<span class=\"string\">&quot;num % 2 == 0&quot;</span>);</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> BaseException(<span class=\"string\">&quot;something bad with 2&quot;</span>, <span class=\"number\">400</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (num % <span class=\"number\">3</span> == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">            log.info(<span class=\"string\">&quot;num % 3 == 0&quot;</span>);</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> BaseException(<span class=\"string\">&quot;something bad whitch 3&quot;</span>, <span class=\"number\">400</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (num % <span class=\"number\">5</span> == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">            log.info(<span class=\"string\">&quot;num % 5 == 0&quot;</span>);</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> ProgramException(<span class=\"string\">&quot;something bad whitch 5&quot;</span>, <span class=\"number\">400</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (num % <span class=\"number\">7</span> == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">            log.info(<span class=\"string\">&quot;num % 7 == 0&quot;</span>);</span><br><span class=\"line\">            <span class=\"keyword\">int</span> res = <span class=\"number\">1</span> / <span class=\"number\">0</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> JsonResult.ok();</span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span> (BufferUnderflowException e) &#123;</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;error&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> JsonResult.error(<span class=\"string\">&quot;error&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"3-3-3ã€é’ˆå¯¹æ¥å£é…ç½®ç†”æ–­æ–¹æ³•\"><a href=\"#3-3-3ã€é’ˆå¯¹æ¥å£é…ç½®ç†”æ–­æ–¹æ³•\" class=\"headerlink\" title=\"3.3.3ã€é’ˆå¯¹æ¥å£é…ç½®ç†”æ–­æ–¹æ³•\"></a>3.3.3ã€é’ˆå¯¹æ¥å£é…ç½®ç†”æ–­æ–¹æ³•</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * éœ€è¦å‚æ•°ä¸€è‡´ï¼Œå¹¶ä¸”åŠ ä¸Šç›¸åº”å¼‚å¸¸</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> request</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> response</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> num</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> exception</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> JsonResult <span class=\"title\">fallbackMethod</span><span class=\"params\">(HttpServletRequest request, HttpServletResponse response, <span class=\"meta\">@RequestParam</span> Integer num, BulkheadFullException exception)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> JsonResult.error(<span class=\"string\">&quot;error ç†”æ–­&quot;</span> + num );</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"3-3-4ã€é…ç½®è§„åˆ™\"><a href=\"#3-3-4ã€é…ç½®è§„åˆ™\" class=\"headerlink\" title=\"3.3.4ã€é…ç½®è§„åˆ™\"></a>3.3.4ã€é…ç½®è§„åˆ™</h3><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">resilience4j.circuitbreaker:</span></span><br><span class=\"line\">    <span class=\"attr\">instances:</span></span><br><span class=\"line\">        <span class=\"attr\">backendA:</span></span><br><span class=\"line\">            <span class=\"attr\">registerHealthIndicator:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">            <span class=\"attr\">slidingWindowSize:</span> <span class=\"number\">100</span></span><br><span class=\"line\">        <span class=\"attr\">backendB:</span></span><br><span class=\"line\">            <span class=\"attr\">registerHealthIndicator:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">            <span class=\"attr\">slidingWindowSize:</span> <span class=\"number\">10</span></span><br><span class=\"line\">            <span class=\"attr\">permittedNumberOfCallsInHalfOpenState:</span> <span class=\"number\">3</span></span><br><span class=\"line\">            <span class=\"attr\">slidingWindowType:</span> <span class=\"string\">TIME_BASED</span></span><br><span class=\"line\">            <span class=\"attr\">minimumNumberOfCalls:</span> <span class=\"number\">20</span></span><br><span class=\"line\">            <span class=\"attr\">waitDurationInOpenState:</span> <span class=\"string\">50s</span></span><br><span class=\"line\">            <span class=\"attr\">failureRateThreshold:</span> <span class=\"number\">50</span></span><br><span class=\"line\">            <span class=\"attr\">eventConsumerBufferSize:</span> <span class=\"number\">10</span></span><br><span class=\"line\">            <span class=\"attr\">recordFailurePredicate:</span> <span class=\"string\">io.github.robwin.exception.RecordFailurePredicate</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">resilience4j.retry:</span></span><br><span class=\"line\">    <span class=\"attr\">instances:</span></span><br><span class=\"line\">        <span class=\"attr\">backendA:</span></span><br><span class=\"line\">            <span class=\"attr\">maxRetryAttempts:</span> <span class=\"number\">3</span></span><br><span class=\"line\">            <span class=\"attr\">waitDuration:</span> <span class=\"string\">10s</span></span><br><span class=\"line\">            <span class=\"attr\">enableExponentialBackoff:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">            <span class=\"attr\">exponentialBackoffMultiplier:</span> <span class=\"number\">2</span></span><br><span class=\"line\">            <span class=\"attr\">retryExceptions:</span></span><br><span class=\"line\">                <span class=\"bullet\">-</span> <span class=\"string\">org.springframework.web.client.HttpServerErrorException</span></span><br><span class=\"line\">                <span class=\"bullet\">-</span> <span class=\"string\">java.io.IOException</span></span><br><span class=\"line\">            <span class=\"attr\">ignoreExceptions:</span></span><br><span class=\"line\">                <span class=\"bullet\">-</span> <span class=\"string\">io.github.robwin.exception.BusinessException</span></span><br><span class=\"line\">        <span class=\"attr\">backendB:</span></span><br><span class=\"line\">            <span class=\"attr\">maxRetryAttempts:</span> <span class=\"number\">3</span></span><br><span class=\"line\">            <span class=\"attr\">waitDuration:</span> <span class=\"string\">10s</span></span><br><span class=\"line\">            <span class=\"attr\">retryExceptions:</span></span><br><span class=\"line\">                <span class=\"bullet\">-</span> <span class=\"string\">org.springframework.web.client.HttpServerErrorException</span></span><br><span class=\"line\">                <span class=\"bullet\">-</span> <span class=\"string\">java.io.IOException</span></span><br><span class=\"line\">            <span class=\"attr\">ignoreExceptions:</span></span><br><span class=\"line\">                <span class=\"bullet\">-</span> <span class=\"string\">io.github.robwin.exception.BusinessException</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">resilience4j.bulkhead:</span></span><br><span class=\"line\">    <span class=\"attr\">instances:</span></span><br><span class=\"line\">        <span class=\"attr\">backendA:</span></span><br><span class=\"line\">            <span class=\"attr\">maxConcurrentCalls:</span> <span class=\"number\">10</span></span><br><span class=\"line\">        <span class=\"attr\">backendB:</span></span><br><span class=\"line\">            <span class=\"attr\">maxWaitDuration:</span> <span class=\"string\">10ms</span></span><br><span class=\"line\">            <span class=\"attr\">maxConcurrentCalls:</span> <span class=\"number\">20</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">resilience4j.thread-pool-bulkhead:</span></span><br><span class=\"line\">  <span class=\"attr\">instances:</span></span><br><span class=\"line\">    <span class=\"attr\">backendC:</span></span><br><span class=\"line\">      <span class=\"attr\">maxThreadPoolSize:</span> <span class=\"number\">1</span></span><br><span class=\"line\">      <span class=\"attr\">coreThreadPoolSize:</span> <span class=\"number\">1</span></span><br><span class=\"line\">      <span class=\"attr\">queueCapacity:</span> <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">resilience4j.ratelimiter:</span></span><br><span class=\"line\">    <span class=\"attr\">instances:</span></span><br><span class=\"line\">        <span class=\"attr\">backendA:</span></span><br><span class=\"line\">            <span class=\"attr\">limitForPeriod:</span> <span class=\"number\">10</span></span><br><span class=\"line\">            <span class=\"attr\">limitRefreshPeriod:</span> <span class=\"string\">1s</span></span><br><span class=\"line\">            <span class=\"attr\">timeoutDuration:</span> <span class=\"number\">0</span></span><br><span class=\"line\">            <span class=\"attr\">registerHealthIndicator:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">            <span class=\"attr\">eventConsumerBufferSize:</span> <span class=\"number\">100</span></span><br><span class=\"line\">        <span class=\"attr\">backendB:</span></span><br><span class=\"line\">            <span class=\"attr\">limitForPeriod:</span> <span class=\"number\">6</span></span><br><span class=\"line\">            <span class=\"attr\">limitRefreshPeriod:</span> <span class=\"string\">500ms</span></span><br><span class=\"line\">            <span class=\"attr\">timeoutDuration:</span> <span class=\"string\">3s</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">resilience4j.timelimiter:</span></span><br><span class=\"line\">    <span class=\"attr\">instances:</span></span><br><span class=\"line\">        <span class=\"attr\">backendA:</span></span><br><span class=\"line\">            <span class=\"attr\">timeoutDuration:</span> <span class=\"string\">2s</span></span><br><span class=\"line\">            <span class=\"attr\">cancelRunningFuture:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">        <span class=\"attr\">backendB:</span></span><br><span class=\"line\">            <span class=\"attr\">timeoutDuration:</span> <span class=\"string\">1s</span></span><br><span class=\"line\">            <span class=\"attr\">cancelRunningFuture:</span> <span class=\"literal\">false</span></span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>é…ç½®çš„è§„åˆ™å¯ä»¥è¢«ä»£ç è¦†ç›–</p>\n</blockquote>\n<h3 id=\"3-3-5ã€é…ç½®ç›‘æ§\"><a href=\"#3-3-5ã€é…ç½®ç›‘æ§\" class=\"headerlink\" title=\"3.3.5ã€é…ç½®ç›‘æ§\"></a>3.3.5ã€é…ç½®ç›‘æ§</h3><blockquote>\n<p>å¦‚grafanaç­‰</p>\n</blockquote>\n<h1 id=\"è‚†ã€å…³æ³¨ç‚¹\"><a href=\"#è‚†ã€å…³æ³¨ç‚¹\" class=\"headerlink\" title=\"è‚†ã€å…³æ³¨ç‚¹\"></a>è‚†ã€å…³æ³¨ç‚¹</h1><ul>\n<li>æ˜¯å¦éœ€è¦è¿‡æ»¤éƒ¨åˆ†å¼‚å¸¸</li>\n<li>æ˜¯å¦éœ€è¦å…¨å±€é»˜è®¤è§„åˆ™</li>\n<li>å¯èƒ½éœ€è¦å¼•å…¥å…¶ä»–ä¸­é—´ä»¶</li>\n<li>k8sæµé‡æ§åˆ¶</li>\n<li>è§„åˆ™å­˜å‚¨å’ŒåŠ¨æ€ä¿®æ”¹</li>\n<li>æ¥å…¥æ”¹é€ ä»£ä»·</li>\n</ul>\n<h1 id=\"ã€åé¢çš„è¯ã€‘\"><a href=\"#ã€åé¢çš„è¯ã€‘\" class=\"headerlink\" title=\"ã€åé¢çš„è¯ã€‘\"></a>ã€<strong>åé¢çš„è¯</strong>ã€‘</h1><p>ä¸ªäººå»ºè®®çš„è¯ï¼Œæ¯”è¾ƒæ¨èsentinelï¼Œå®ƒæä¾›äº†å¾ˆå¤šæ¥å£ä¾¿äºå¼€å‘è€…è‡ªå·±æ‹“å±•ï¼ŒåŒæ—¶æˆ‘è§‰å¾—ä»–çš„è§„åˆ™åŠ¨æ€æ›´æ–°ä¹Ÿæ¯”è¾ƒæ–¹ä¾¿ã€‚æœ€åæ˜¯ç›¸å…³ç¤ºä¾‹ä»£ç :<a href=\"https://github.com/eelve/limiting\">å•ä½“åº”ç”¨ç¤ºä¾‹ä»£ç </a></p>\n<hr>\n<p><img src=\"https://image.eelve.com/eblog/eblog-b269767ff45b4e01a1c380e38898c1c0.png\" alt=\"è–ç±³ç¬”è®°\"></p>\n","raw":null,"categories":[{"name":"springboot","path":"api/categories/springboot.json"}],"tags":[{"name":"java","path":"api/tags/java.json"},{"name":"springboot","path":"api/tags/springboot.json"}]}]}